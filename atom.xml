<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://koko-club.github.io</id>
    <title>Imcry</title>
    <updated>2023-02-27T07:58:19.859Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://koko-club.github.io"/>
    <link rel="self" href="https://koko-club.github.io/atom.xml"/>
    <subtitle>æ˜¥é£å¾—æ„é©¬è¹„ç–¾ï¼Œä¸€æ—¥çœ‹å°½é•¿å®‰èŠ±</subtitle>
    <logo>https://koko-club.github.io/images/avatar.png</logo>
    <icon>https://koko-club.github.io/favicon.ico</icon>
    <rights>All rights reserved 2023, Imcry</rights>
    <entry>
        <title type="html"><![CDATA[æ¬¢è¿æ¥åˆ°Gridea]]></title>
        <id>https://koko-club.github.io/post/huan-ying-lai-dao-gridea/</id>
        <link href="https://koko-club.github.io/post/huan-ying-lai-dao-gridea/">
        </link>
        <updated>2023-02-27T07:06:43.000Z</updated>
        <content type="html"><![CDATA[<p>å½“ä½ çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œæ„å‘³ç€ä½ çš„çœ¼ç›æ˜¯çå¼€çš„ï¼Œè°¢è°¢ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[jenkins]]></title>
        <id>https://koko-club.github.io/post/jenkins/</id>
        <link href="https://koko-club.github.io/post/jenkins/">
        </link>
        <updated>2023-02-19T16:00:00.000Z</updated>
        <content type="html"><![CDATA[<h1 id="jenkins">jenkins</h1>
<h2 id="ä»‹ç»">ä»‹ç»</h2>
<p>Jenkinsæ˜¯ä¸€ä¸ªå¼€æºçš„ã€æä¾›å‹å¥½æ“ä½œç•Œé¢çš„æŒç»­é›†æˆ(CI)å·¥å…·ï¼Œèµ·æºäºHudsonï¼Œä¸»è¦ç”¨äºæŒç»­ã€è‡ªåŠ¨çš„æ„å»º/æµ‹è¯•è½¯ä»¶é¡¹ç›®ã€ç›‘æ§å¤–éƒ¨ä»»åŠ¡çš„è¿è¡Œã€‚Jenkinsç”¨Javaè¯­è¨€ç¼–å†™ï¼Œå¯åœ¨Tomcatç­‰æµè¡Œçš„servletå®¹å™¨ä¸­è¿è¡Œï¼Œä¹Ÿå¯ç‹¬ç«‹è¿è¡Œã€‚é€šå¸¸ä¸ç‰ˆæœ¬ç®¡ç†å·¥å…·(SCM)ã€æ„å»ºå·¥å…·ç»“åˆä½¿ç”¨ã€‚å¸¸ç”¨çš„ç‰ˆæœ¬æ§åˆ¶å·¥å…·æœ‰SVNã€GITï¼Œæ„å»ºå·¥å…·æœ‰Mavenã€Antã€Gradleã€‚</p>
<p>jenkinså®˜ç½‘ï¼šhttps://www.jenkins.io/</p>
<h3 id="æŒç»­é›†æˆci">æŒç»­é›†æˆCI</h3>
<p>æŒç»­é›†æˆæ˜¯ä¸€ç§è½¯ä»¶å¼€å‘å®è·µï¼Œå³å›¢é˜Ÿå¼€å‘æˆå‘˜ç»å¸¸é›†æˆä»–ä»¬çš„å·¥ä½œï¼Œé€šå¸¸æ¯ä¸ªæˆå‘˜æ¯å¤©è‡³å°‘é›†æˆä¸€æ¬¡ï¼Œä¹Ÿå°±æ„å‘³ç€æ¯å¤©å¯èƒ½ä¼šå‘ç”Ÿå¤šæ¬¡é›†æˆã€‚æ¯æ¬¡é›†æˆéƒ½é€šè¿‡è‡ªåŠ¨åŒ–çš„æ„å»ºï¼ˆåŒ…æ‹¬<a href="https://baike.baidu.com/item/%E7%BC%96%E8%AF%91/1258343?fromModule=lemma_inlink">ç¼–è¯‘</a>ï¼Œå‘å¸ƒï¼Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼‰æ¥éªŒè¯ï¼Œä»è€Œå°½æ—©åœ°å‘ç°é›†æˆé”™è¯¯ã€‚</p>
<p>é€šä¿—æ¥è®²æŒç»­é›†æˆå°±æ˜¯è½¯ä»¶å¼€å‘äººå‘˜æäº¤ä»£ç ä»¥åè‡ªåŠ¨åŒ–æ„å»ºã€å‘å¸ƒã€æµ‹è¯•ã€‚</p>
<figure data-type="image" tabindex="1"><img src="https://koko-club.github.io/post-images/jenkins/webp.webp" alt="img" loading="lazy"></figure>
<h3 id="æŒç»­äº¤ä»˜cd">æŒç»­äº¤ä»˜CD</h3>
<p>CD(Continuous Deliveryï¼Œ ä¸­æ–‡æ„æ€æŒç»­äº¤ä»˜)æ˜¯åœ¨æŒç»­é›†æˆçš„åŸºç¡€ä¸Šï¼Œå°†é›†æˆåçš„ä»£ç éƒ¨ç½²åˆ°æ›´è´´è¿‘çœŸå®è¿è¡Œç¯å¢ƒ(ç±»ç”Ÿäº§ç¯å¢ƒ)ä¸­ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å®Œæˆå•å…ƒæµ‹è¯•åï¼Œå¯ä»¥æŠŠä»£ç éƒ¨ç½²åˆ°è¿æ¥æ•°æ®åº“çš„Stagingç¯å¢ƒä¸­æ›´å¤šçš„æµ‹è¯•ã€‚å¦‚æœä»£ç æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥ç»§ç»­æ‰‹åŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚ä¸‹å›¾ååº”çš„æ˜¯CI/CD çš„å¤§æ¦‚å·¥ä½œæ¨¡å¼ã€‚</p>
<figure data-type="image" tabindex="2"><img src="https:////upload-images.jianshu.io/upload_images/6464255-ba088ec7257062c0.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" alt="img" loading="lazy"></figure>
<h2 id="éƒ¨ç½²">éƒ¨ç½²</h2>
<p>éƒ¨ç½²æ–¹å¼ä¸€èˆ¬ç°åœ¨å°±åˆ†ä¸ºäºŒè¿›åˆ¶éƒ¨ç½²å’Œdocker(k8s)éƒ¨ç½²ã€‚</p>
<p>å®˜ç½‘ä¸‹è½½ï¼šhttps://www.jenkins.io/download/</p>
<h3 id="äºŒè¿›åˆ¶åŒ…éƒ¨ç½²">äºŒè¿›åˆ¶åŒ…éƒ¨ç½²</h3>
<p>jenkinsæœ¬èº«æ˜¯åŸºäºjavaå¼€å‘ï¼Œå…¶äºŒè¿›åˆ¶åŒ…æ˜¯waræ–‡ä»¶ï¼Œè¿è¡Œäºtomcatã€‚</p>
<p>1.éƒ¨ç½²tomcat</p>
<p>2.ä¸‹è½½jenkinsçš„waréƒ¨ç½²åŒ…</p>
<p>3.å°†åŒ…æ”¾äºtomcatçš„webappsç›®å½•ä¸‹ï¼Œå¯åŠ¨tomcatã€‚é»˜è®¤8080ç«¯å£è®¿é—®ã€‚</p>
<h3 id="k8sdockeréƒ¨ç½²">k8s(docker)éƒ¨ç½²</h3>
<h4 id="dockeréƒ¨ç½²">dockeréƒ¨ç½²</h4>
<p>dockeruhbå®˜ç½‘é•œåƒåœ°å€ï¼šhttps://hub.docker.com/r/jenkins/jenkins</p>
<p>1.æ‹‰å–é•œåƒ	docker pull jenkins/jenkins</p>
<p>2.åœ¨æœ¬åœ°åˆ›å»ºJenkins-homeç›®å½•ï¼šmkdir -p /home/jenkins_home ç”¨äºæ˜ å°„</p>
<p>3.å¯åŠ¨Jenkinså®¹å™¨ï¼šdocker run -d --name jenkins -p 8080:8080 -p 50000:50000 -v /home/jenkins_home:/var/jenkins_home jenkins/jenkins</p>
<p>â€‹	-p 50000:50000 ï¼Œ<code>è¿™ä¸ªç«¯å£æ˜ å°„è¦ä¿æŒä¸€è‡´</code>ï¼Œå¦åˆ™agentæ— æ³•å¯åŠ¨ï¼Œagentéƒ¨åˆ†ä¸»è¦ä½œç”¨å°±æ˜¯å‘Šè¯‰Jenkins,é€‰æ‹©å“ªå°èŠ‚ç‚¹æœºå™¨å»æ‰§è¡ŒPipelineä»£ç </p>
<p>4ã€ç„¶åç½‘ç«™ä¸Šè¾“å…¥IP:8080è®¿é—®ï¼Œéœ€è¦è¾“å…¥å¯†ç ï¼Œå¤åˆ¶é¡µé¢ä¸Šçš„è·¯å¾„ï¼Œåœ¨æœåŠ¡å™¨ä¸Šè¾“å…¥cat è·¯å¾„æŸ¥çœ‹å¯†ç ï¼Œç²˜è´´åˆ°è¾“å…¥æ¡†ä¹‹åä¸‹ä¸€æ­¥å°±å¥½</p>
<p>â€‹	cat / var/jenkins_home/secrets/initialadminpassword</p>
<h4 id="k8séƒ¨ç½²">k8séƒ¨ç½²</h4>
<p>k8sä¸Šé¢ä¸€èˆ¬æœ‰ä¸¤ç§éƒ¨ç½²æ–¹å¼ï¼Œä½¿ç”¨yamlæ–‡ä»¶éƒ¨ç½²å’Œhelmæ–¹å¼éƒ¨ç½²ã€‚</p>
<h5 id="helmæ–¹å¼">helmæ–¹å¼</h5>
<p>helmæ–¹å¼å»ºè®®ä½¿ç”¨å®˜æ–¹é•œåƒï¼Œè¿™é‡Œå¦‚æœç”¨çš„æ˜¯bitnamiçš„é•œåƒåˆ™å»ºè®®æ›¿æ¢æˆå®˜æ–¹ï¼Œæˆ‘è¿™è¾¹ä½¿ç”¨å‘ç°bitnamiçš„jenkinsæœ‰äº›ç³»ç»Ÿé…ç½®æ— æ³•æŒä¹…åŒ–ã€‚</p>
<pre><code>helm repo add jenkins  https://charts.jenkins.io      
helm pull jenkins  https://charts.jenkins.io    
tar -xvf jenkins-VERSION.tar.gz
cd jenkins
vim values.yaml
#æ ¹æ®éœ€æ±‚æ›´æ”¹é…ç½®
é‡è¦çš„é…ç½®åŒ…æ‹¬jenkinså¯†ç ï¼Œsvcç±»å‹ï¼ŒjenkinsæŒä¹…åŒ–å­˜å‚¨é…ç½®ï¼ˆPVCï¼‰
æ”¹å®Œä»¥å
helm install jenkins . -n è¦éƒ¨ç½²çš„åç§°ç©ºé—´
</code></pre>
<h5 id="yamléƒ¨ç½²">yamléƒ¨ç½²</h5>
<p>jenkins.yaml:</p>
<pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: jks
spec:
  replicas: 1
  selector:
    matchLabels:
      app: jks
  template:
    metadata:
      labels:
        app: jks
    spec:
      containers:
      - name: jks
        image: jenkins/jenkins:2.319.3-centos7-jdk8
        imagePullPolicy: Always
        ports:
        - containerPort: 8080
        volumeMounts:
        - name: jks-home
          mountPath: /var/jenkins_home
        - name: time-zone                            #å®¹å™¨å†…æŒ‚è½½ç‚¹åç§°
          mountPath: /etc/localtime              #å®¹å™¨å†…æŒ‚è½½ç‚¹è·¯å¾„ï¼Œå¯ä»¥æ˜¯æ–‡ä»¶æˆ–ç›®å½•
      affinity: #è¿™é‡Œç”±äºjenkinsé•œåƒå¾ˆå¤§ï¼Œé¿å…åˆ æ‰podé‡æ„åˆ‡æ¢èŠ‚ç‚¹åˆè¦æ‹‰å–æ•°æ®ï¼Œæ‰€ä»¥å›ºå®šå…¶èŠ‚ç‚¹ã€‚
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
            - matchExpressions:
              - key: kubernetes.io/hostname # æ ‡ç­¾é”®å
                operator: In
                values:
                - node2 
      initContainers:
      - args:
        - -c
        - chmod 755 /var/jenkins_home &amp;&amp; chown 1000:1000 /var/jenkins_home   ### è¿™é‡Œå°†ä¸Šä¸€æ­¥æ‰€è®°å½•çš„æƒé™å±ç»„è¿›è¡Œæ›´æ”¹
        command:
        - /bin/sh
        image: centos
        imagePullPolicy: IfNotPresent
        name: chauth
        securityContext:
          privileged: true    ###  å»ºè®®å¼€å¯ç‰¹æƒæ¨¡å¼
        volumeMounts:
        - mountPath: /var/jenkins_home      ### initcä¹Ÿè¦å¯¹æ¬¡æ•°æ®å·è¿›è¡ŒæŒ‚è½½
          name: jks-home
      volumes:
      - name: time-zone                              #æ•°æ®å·åç§°ï¼Œéœ€è¦ä¸å®¹å™¨å†…æŒ‚è½½ç‚¹åç§°ä¸€è‡´
        hostPath:
          path: /etc/localtime  
      - name: jks-home
        persistentVolumeClaim:
            claimName: jks-pvc
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: jks-pvc
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 200Gi
---
apiVersion: v1
kind: Service
metadata:
  name: jks
spec:
  selector:
    app: jks
  type: NodePort
  ports:
    - port: 8080
      targetPort: 8080
      nodePort: 32089

</code></pre>
<p>kubectl apply -f jenkins.yaml</p>
<p>éƒ¨ç½²å®Œåè®¿é—®jenkins:</p>
<figure data-type="image" tabindex="3"><img src="https://koko-club.github.io/post-images/jenkins/image-20230215154224734.png" alt="image-20230215154224734" loading="lazy"></figure>
<p>è¿™é‡Œè¿˜æ˜¯å’Œä¸Šé¢ä¸€æ ·ï¼Œè¿›å…¥å®¹å™¨æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶</p>
<pre><code>[root@node1 jenkins_test]# kubectl exec -it jks-698b6564fb-5692t -n k3s-test bash 
kubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD] -- [COMMAND] instead.
Defaulted container &quot;jks&quot; out of: jks, chauth (init)
bash-4.2$ cat /var/jenkins_home/secrets/initialAdminPassword
54c0b40b20f34b4ca7b75840c68883a1
ç„¶åå¡«å…¥ç®¡ç†å‘˜å¯†ç å°±ok
å®‰è£…çš„æ’ä»¶å¦‚æœä¸çŸ¥é“å¯ä»¥å…ˆé€‰æ‹©æ¨èå®‰è£…çš„æ’ä»¶
</code></pre>
<h2 id="ä»»åŠ¡">ä»»åŠ¡</h2>
<p>jenkinsä¸»è¦å°±æ˜¯é€šè¿‡æ‰§è¡Œä»»åŠ¡æ¥å·¥ä½œçš„ï¼Œå·¦è¾¹èœå•ç¬¬ä¸€ä¸ªæŒ‰é’®å°±æ˜¯æ–°å»ºitem</p>
<figure data-type="image" tabindex="4"><img src="https://koko-club.github.io/post-images/jenkins/image-20230215164410954.png" alt="image-20230215164410954" loading="lazy"></figure>
<p>ä¸»è¦ä½¿ç”¨çš„å°±æ˜¯è‡ªç”±é¡¹ç›®ã€æµæ°´çº¿ã€å¤šåˆ†æ”¯æµæ°´çº¿ï¼Œè€Œä»ä»»åŠ¡ç±»å‹è§’åº¦æ¥è®²ä¸»è¦å°±åˆ†ä¸ºä¸¤ç§ï¼šæµæ°´çº¿ä¸éæµæ°´çº¿</p>
<h3 id="éæµæ°´çº¿è‡ªç”±é£æ ¼">éæµæ°´çº¿ï¼ˆè‡ªç”±é£æ ¼ï¼‰</h3>
<p>ä¸€èˆ¬ä»»åŠ¡çš„æ­¥éª¤åˆ†ä¸ºï¼šæ¨é€ä»£ç -ã€‹è§¦å‘é’©å­-ã€‹jenkinsä»»åŠ¡æ‰§è¡Œ-ã€‹æ‹‰å–ä»£ç -ã€‹æ„å»ºæ“ä½œ-ã€‹æ„å»ºåæ“ä½œï¼ˆä¸€èˆ¬æ˜¯é€šçŸ¥ï¼‰</p>
<h4 id="æ‹‰å–ä»£ç ">æ‹‰å–ä»£ç </h4>
<p>è¿™é‡Œä»æ‹‰å–ä»£ç å¼€å§‹ï¼š</p>
<p>é¦–å…ˆåœ¨åˆ›å»ºfreestyle projectå‰éœ€è¦å…ˆä¸‹è½½<a href="https://plugins.jenkins.io/git-parameter">Git Parameter</a>æ¨¡å—ï¼Œåœ¨ç³»ç»Ÿç®¡ç†â€”ã€‹æ’ä»¶ç®¡ç†â€”ã€‹å¯é€‰æ’ä»¶ä¸­æœç´¢git parameterï¼Œä¸‹è½½å¹¶é‡å¯jenkinsã€‚</p>
<p>æ–°å»ºä»»åŠ¡åœ¨æºç ç®¡ç†ä¸­é€‰æ‹©gitï¼ŒRepository URLè¾“å…¥gitä»“åº“åœ°å€ï¼ŒCredentialsæ·»åŠ ä¸€ä¸ªå…¨å±€å‡­æ®ç”¨äºgitç™»å½•ï¼ŒæŒ‡å®šåˆ†æ”¯ä¸­é€‰æ‹©è¦æ‹‰å–çš„åˆ†æ”¯ã€‚</p>
<h4 id="æ„å»ºè§¦å‘å™¨">æ„å»ºè§¦å‘å™¨</h4>
<p>æ„å»ºè§¦å‘å™¨ä¸€èˆ¬ç”¨äºåœ¨ä»£ç ä»“åº“æ¨é€ä»£ç ä¹‹åï¼Œè§¦å‘è§¦å‘å™¨ç„¶åjenkinså¼€å§‹æ„å»ºå¯¹åº”çš„ä»»åŠ¡ã€‚è¿™ä¸ªéœ€è¦<a href="https://plugins.jenkins.io/generic-webhook-trigger">Generic Webhook Trigger</a>æ’ä»¶ï¼Œå®‰è£…å®Œæ¯•é‡å¯å³å¯ã€‚</p>
<h5 id="webhookè§¦å‘jenkinsä»»åŠ¡é…ç½®">webhookè§¦å‘jenkinsä»»åŠ¡é…ç½®</h5>
<p>é¦–å…ˆéœ€è¦åœ¨jenkinsä»»åŠ¡ä¸­é…ç½®è§¦å‘å™¨</p>
<figure data-type="image" tabindex="5"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216111031873.png" alt="image-20230216111031873" loading="lazy"></figure>
<p>ä¾‹å¦‚è¿™é‡Œçš„tokenè®¾ç½®çš„æ˜¯testï¼Œåˆ™è§¦å‘å™¨urlä¸ºï¼šhttp://jenkins/generic-webhook-trigger/invok?token=test</p>
<p>ä¸€èˆ¬ä»£ç ä»“åº“å¦‚gitlabéƒ½ä¼šåœ¨å…·ä½“é¡¹ç›®é‡Œé¢æœ‰webhooké…ç½®ï¼Œå¦‚ä¸‹</p>
<figure data-type="image" tabindex="6"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216110814851.png" alt="image-20230216110814851" loading="lazy"></figure>
<figure data-type="image" tabindex="7"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216110830102.png" alt="image-20230216110830102" loading="lazy"></figure>
<p>é¦–å…ˆå°†åˆšåˆšè®¾ç½®æ‹¿åˆ°çš„è§¦å‘å™¨urlå¡«å…¥è¿™ä¸ªURLä¸­ï¼Œç„¶åè®¾ç½®è§¦å‘çš„åŠ¨ä½œï¼Œä¸€èˆ¬push eventså³å¯ï¼Œè¡¨ç¤ºå…¶æ”¶åˆ°pushæ“ä½œæ—¶ï¼Œåˆ™ä¼šè§¦å‘ã€‚åˆ°è¿™é‡Œwebhookè§¦å‘å™¨å°±é…ç½®å®Œæˆäº†ï¼Œå½“gitlabæ¨é€ä»£ç æ—¶ï¼Œjenkinsä¼šç«‹å³æ‰§è¡Œå¯¹åº”é¡¹ç›®çš„ä»»åŠ¡ã€‚</p>
<h4 id="æ„å»ºç¯å¢ƒ">æ„å»ºç¯å¢ƒ</h4>
<p>æ„å»ºç¯å¢ƒä¸»è¦æ„å»ºå‰çš„ä¸€äº›æ“ä½œï¼Œä¾‹å¦‚æ„å»ºå‰åˆ é™¤å·¥ä½œåŒºæ–‡ä»¶ã€ä½¿ç”¨å¯†ç æ–‡ä»¶æˆ–æ–‡æœ¬ã€å¦‚æœå¡ä½åˆ™ç»ˆæ­¢æ„å»ºç­‰ã€‚è¿™ä¸ªé…ç½®ä¸æ˜¯å¿…è¦é…ç½®ï¼Œä¸€èˆ¬ä¸ç”¨å¯¹æ„å»ºç¯å¢ƒåšé…ç½®ã€‚</p>
<figure data-type="image" tabindex="8"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216112310634.png" alt="image-20230216112310634" loading="lazy"></figure>
<h4 id="æ„å»º">æ„å»º</h4>
<p>æ„å»ºæœ€å¸¸ç”¨çš„å°±æ˜¯æ‰§è¡Œshellå‘½åï¼Œæ‹‰å–ä»£ç ä»¥åçš„ç¼–è¯‘-ã€‹æ‰“åŒ…æ¨é€dockeré•œåƒï¼ˆå¦‚æœä¸æ‰“åŒ…å°±æ˜¯äºŒè¿›åˆ¶éƒ¨ç½²ï¼‰-ã€‹éƒ¨ç½² æ“ä½œéƒ½åœ¨è¿™ä¸€æ­¥å®Œæˆã€‚</p>
<figure data-type="image" tabindex="9"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216112840235.png" alt="image-20230216112840235" loading="lazy"></figure>
<p>â€‹	<img src="https://koko-club.github.io/post-images/jenkins/image-20230216112904780.png" alt="image-20230216112904780" loading="lazy"></p>
<p>ç›´æ¥åœ¨é‡Œé¢æ‰§è¡Œshellå‘½ä»¤æˆ–è€…æ‰§è¡Œè„šæœ¬å°±è¡Œäº†ã€‚</p>
<h4 id="æ„å»ºåæ“ä½œ">æ„å»ºåæ“ä½œ</h4>
<p>æ„å»ºåå¸¸ç”¨é…ç½®æ˜¯æ„å»ºé€šçŸ¥ï¼Œä¸€èˆ¬å¸¸ç”¨çš„æ˜¯emailé€šçŸ¥ï¼Œjenkinsé»˜è®¤æ”¯æŒemailé€šçŸ¥</p>
<figure data-type="image" tabindex="10"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216113950123.png" alt="image-20230216113950123" loading="lazy"></figure>
<p>ä½†ç°åœ¨æ¯”è¾ƒæµè¡Œç”¨webhookè¿›è¡Œé€šçŸ¥ï¼Œjenkinsé»˜è®¤ä¸æ”¯æŒè¿™ç§é…ç½®ï¼Œéœ€è¦é¢å¤–ä¸‹è½½æ’ä»¶ã€‚</p>
<h5 id="ä¼ä¸šå¾®ä¿¡é€šçŸ¥">ä¼ä¸šå¾®ä¿¡é€šçŸ¥</h5>
<p>1ã€åœ¨éœ€è¦å‘é€ä¼ä¸šå¾®ä¿¡é€šçŸ¥çš„ç¾¤ä¸­â€œæ·»åŠ ç¾¤æœºå™¨äººâ€ï¼Œå¾—åˆ°webhookåœ°å€</p>
<p>2ã€åœ¨Jenkinsç³»ç»Ÿç®¡ç†-æ’ä»¶ç®¡ç†-å¯é€‰æ’ä»¶ï¼Œæœç´¢&quot;Qy Wechat Notification Plugin&quot;æ’ä»¶ï¼Œä¸‹è½½å¹¶é‡å¯Jenkins</p>
<p>3ã€é…ç½®ç³»ç»Ÿé…ç½®</p>
<p>â€‹		è¾“å…¥webhookåœ°å€ï¼Œç‚¹å‡»ä¿å­˜</p>
<figure data-type="image" tabindex="11"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216131115946.png" alt="image-20230216130625028" loading="lazy"></figure>
<p>å¡«å…¥webhookå³å¯ï¼Œå…¶ä»–å‡ é¡¹éå¿…å¡«é¡¹ã€‚</p>
<h5 id="é’‰é’‰é€šçŸ¥">é’‰é’‰é€šçŸ¥</h5>
<p>1ã€æ‰“å¼€é’‰é’‰ï¼Œè¿›å…¥ç¾¤è®¾ç½®-æ™ºèƒ½ç¾¤åŠ©æ‰‹-æ·»åŠ æœºå™¨äºº-è‡ªå®šä¹‰æœºå™¨äººï¼ˆå¡«å†™æœºå™¨äººåç§°ã€å®‰å…¨è®¾ç½®ã€åè®®ï¼‰å¾—åˆ°webhook</p>
<p>2ã€åœ¨Jenkinsç³»ç»Ÿç®¡ç†-æ’ä»¶ç®¡ç†-å¯é€‰æ’ä»¶ï¼Œæœç´¢â€œDingTalkâ€ï¼Œä¸‹è½½å¹¶é‡å¯Jenkins</p>
<p>3ã€é…ç½®ç³»ç»Ÿé…ç½®</p>
<p>è¿›å…¥ç³»ç»Ÿç®¡ç†-ç³»ç»Ÿé…ç½®-é’‰é’‰ï¼Œ è¾“å…¥webhookåœ°å€ã€idã€åç§°ï¼Œä¸»è¦æ˜¯webhookåœ°å€ä»¥åŠé’‰é’‰é‚£è¾¹æœºå™¨äººæ˜¯å¦é…ç½®äº†å…³é”®å­—å’ŒåŠ å¯†ï¼Œå¦‚æœæœ‰éœ€è¦è¾“å…¥<br>
<img src="https://koko-club.github.io/post-images/jenkins/image-20230216132900385.png" alt="image-20230216132900385" loading="lazy"></p>
<p>ç„¶ååœ¨ä»»åŠ¡é…ç½®ä¸­æœ€ä¸Šé¢å°±å¯ä»¥æ‰¾åˆ°é’‰é’‰æœºå™¨äºº</p>
<figure data-type="image" tabindex="12"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216133032694.png" alt="image-20230216133032694" loading="lazy"></figure>
<p>å¦‚æœä¸å¡«å†™å†…å®¹åˆ™ä¸ºæ’ä»¶é»˜è®¤çš„å‘Šè­¦æ¨¡å¼ï¼Œå¦‚éœ€è‡ªå®šä¹‰éœ€è¦çœ‹æ’ä»¶æ–‡æ¡£ã€‚</p>
<h4 id="mavenä»»åŠ¡">mavenä»»åŠ¡</h4>
<p>å¦‚æœæ˜¯javaé¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨mavené£æ ¼æ¥åˆ›å»ºä»»åŠ¡ã€‚é¦–å…ˆéœ€è¦æŒ‰<a href="https://plugins.jenkins.io/maven-plugin">Maven Integration plugin</a>æ’ä»¶ï¼Œå®‰è£…åé‡å¯åœ¨åˆ›å»ºä»»åŠ¡æ—¶å°±å¯ä»¥çœ‹åˆ°é€‰é¡¹</p>
<figure data-type="image" tabindex="13"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216133527267.png" alt="image-20230216133527267" loading="lazy"></figure>
<p>mavené£æ ¼é¡¹ç›®ä¸»è¦æ˜¯å¤šäº†ä¸€ä¸ªbuildé€‰é¡¹ï¼Œå¯ä»¥ç›´æ¥åœ¨é…ç½®ä¸­æŒ‡å®špom.xmlè¿›è¡Œmavenæ‰“åŒ…ï¼Œä¸åƒè‡ªç”±é£æ ¼ä¸€æ ·æ‰€æœ‰æ“ä½œéƒ½éœ€è¦é€šè¿‡shellæ¥æ‰§è¡Œã€‚è¿™é‡Œéœ€è¦å®‰è£…mavenå·¥å…·ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼šæç¤ºæ‰¾ä¸åˆ°å·¥å…·ï¼Œéœ€è¦åœ¨å…¨å±€å·¥å…·é…ç½®ä¸­å®‰è£…æˆ–æŒ‡å®šå·¥å…·ç›®å½•ã€‚</p>
<figure data-type="image" tabindex="14"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216133703880.png" alt="image-20230216133703880" loading="lazy"></figure>
<h3 id="æµæ°´çº¿pipeline">æµæ°´çº¿ï¼ˆpipelineï¼‰</h3>
<p>æµæ°´çº¿å…¶å®å°±æ˜¯é€šè¿‡pipelineçš„æ–¹å¼æ¥é…ç½®ä»»åŠ¡æµç¨‹ã€‚</p>
<h4 id="pipelineè¯­æ³•">pipelineè¯­æ³•</h4>
<figure data-type="image" tabindex="15"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217104233727.png" alt="image-20230217104233727" loading="lazy"></figure>
<h5 id="pipelineç¤ºä¾‹">pipelineç¤ºä¾‹</h5>
<h6 id="ç¤ºä¾‹1">ç¤ºä¾‹1</h6>
<pre><code>pipeline {
	agent any

	stages{
		stage('è·å–ä»£ç ') {
			steps {
			
	      checkout([$class: 'GitSCM', branches: [[name: '*/master']], doGenerateSubmoduleConfigurations: false, extensions: [], submoduleCfg: [], userRemoteConfigs: [[credentialsId: '4dc04ffd-15bf-46e3-a942-2b58f37bc26b', url: 'git@gitlab.zhangxianwei.com:dev/java.git']]])
			
			}
		}
		
		stage('ä»£ç æ£€æµ‹'){
			steps {
				echo &quot;sonarqube check....&quot;
			}
		}		
		stage('ä»£ç æ„å»º'){
			steps {
				echo &quot;maven build.....&quot;
			}
		}	
		stage('ä»£ç éƒ¨ç½²'){
			steps {
			    echo &quot;echo sh&quot;
			//	sh -x '/server/scripts/deploy_html_tag.sh'
			}
		}
	}
	
}
</code></pre>
<h6 id="javaé¡¹ç›®æ„å»ºpipelineç¤ºä¾‹">javaé¡¹ç›®æ„å»ºpipelineç¤ºä¾‹</h6>
<pre><code>pipeline {
    agent {
        label &quot;edge-node&quot; 
    } 
    options {
    buildDiscarder(logRotator(numToKeepStr: '3'))
    disableConcurrentBuilds()
    }
    stages {

        stage('Check'){
            steps {
                sh &quot;mvn sonar:sonar&quot;
            }
        }
        stage('Clean') {
            steps {
               sh &quot;mvn clean&quot;
            }
        }
        stage('Build') {
            steps {
                sh &quot;mvn compile&quot;
            }
        }
        stage('Package') {
            steps {
                sh &quot;mvn package -Dmaven.test.skip=true -P&quot;+env.BRANCH_NAME
            }
        }
        stage('Deploy') {
            steps {
                sh &quot;mvn deploy -Dmaven.test.skip=true -P&quot;+env.BRANCH_NAME
            }
        }

        stage('IN') {
            steps {
                 sh &quot;~/kubectl_update.sh ${env.WORKSPACE} ${env.JOB_NAME}&quot;
            }
        }
    }
     post {
        success {
            dingTalk(
                robot: 'jenkins', 
                type:'MARKDOWN', 
                title: &quot;æ„å»ºæˆåŠŸ: ${JOB_NAME}&quot;, 
                text: [&quot;## [${JOB_NAME}](${JOB_URL})&quot;,
                       &quot;---&quot;,
                       &quot;- ä»»åŠ¡: [${BUILD_DISPLAY_NAME}](${BUILD_URL})&quot;,
                       &quot;- çŠ¶æ€: &lt;font color=green&gt;æˆåŠŸ&lt;/font&gt;&quot;,
                       &quot;- æŒç»­æ—¶é—´: ${currentBuild.durationString}&quot;,	],	
            )
        }
        failure {
            dingTalk(
                robot: 'jenkins', 
                type:'MARKDOWN', 
                title: &quot;æ„å»ºå¤±è´¥: ${JOB_NAME}&quot;, 
                text: [&quot;## [${JOB_NAME}](${JOB_URL})&quot;,
                       &quot;---&quot;,
                       &quot;- ä»»åŠ¡: [${BUILD_DISPLAY_NAME}](${BUILD_URL})&quot;,
                       &quot;- çŠ¶æ€: &lt;font color=red&gt;å¤±è´¥&lt;/font&gt;&quot;,
                       &quot;- æŒç»­æ—¶é—´: ${currentBuild.durationString}&quot;,	],		
            ) 
        }
    }
}
</code></pre>
<h6 id="å‰ç«¯é¡¹ç›®æ„å»ºpipelineç¤ºä¾‹">å‰ç«¯é¡¹ç›®æ„å»ºpipelineç¤ºä¾‹</h6>
<pre><code>pipeline {
    agent {
        label &quot;edge-node&quot;
    }

    stages {

        stage('Check'){
            steps {
                sh &quot;~/sonar-scanner-4.7.0.2747-linux/bin/sonar-scanner -Dsonar.login=admin -Dsonar.password=finsi0t.c0m&quot; 
            }
        }
        stage('Clean') {
            steps {
               sh &quot;npm cache clean --force&quot;
            }
        }
        stage('Build') {
            steps {
                sh &quot;npm install &amp;&amp; npm run build:pro&quot;
            }
        }
        stage('Install') {
            steps {
               sh &quot;~/kubectl_update.sh ${env.WORKSPACE} ${env.JOB_NAME}&quot;
            } 
        }


    }
    options {
        buildDiscarder(logRotator(numToKeepStr: '3'))
        disableConcurrentBuilds()
    }
     post {
        success {
            dingTalk(
                robot: 'jenkins', 
                type:'MARKDOWN', 
                title: &quot;æ„å»ºæˆåŠŸ: ${JOB_NAME}&quot;, 
                text: [&quot;## [${JOB_NAME}](${JOB_URL})&quot;,
                       &quot;---&quot;,
                       &quot;- ä»»åŠ¡: [${BUILD_DISPLAY_NAME}](${BUILD_URL})&quot;,
                       &quot;- çŠ¶æ€: &lt;font color=green&gt;æˆåŠŸ&lt;/font&gt;&quot;,
                       &quot;- æŒç»­æ—¶é—´: ${currentBuild.durationString}&quot;,	],	
            )
        }
        failure {
            dingTalk(
                robot: 'jenkins', 
                type:'MARKDOWN', 
                title: &quot;æ„å»ºå¤±è´¥: ${JOB_NAME}&quot;, 
                text: [&quot;## [${JOB_NAME}](${JOB_URL})&quot;,
                       &quot;---&quot;,
                       &quot;- ä»»åŠ¡: [${BUILD_DISPLAY_NAME}](${BUILD_URL})&quot;,
                       &quot;- çŠ¶æ€: &lt;font color=red&gt;å¤±è´¥&lt;/font&gt;&quot;,
                       &quot;- æŒç»­æ—¶é—´: ${currentBuild.durationString}&quot;,	],		
            ) 
        }
    }
}
</code></pre>
<h4 id="åˆ›å»ºæµæ°´çº¿é¡¹ç›®">åˆ›å»ºæµæ°´çº¿é¡¹ç›®</h4>
<figure data-type="image" tabindex="16"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216152357088.png" alt="image-20230216152357088" loading="lazy"></figure>
<figure data-type="image" tabindex="17"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216152342895.png" alt="image-20230216152342895" loading="lazy"></figure>
<figure data-type="image" tabindex="18"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216153134214.png" alt="image-20230216153134214" loading="lazy"></figure>
<p>è¿™é‡Œpipelineæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯ç›´æ¥åœ¨jenkinsä¸Šé¢å†™ï¼Œè¿˜æœ‰ä¸€ç§æ˜¯æ¥è‡ªä»“åº“çš„pipelineæ–‡ä»¶ï¼Œå¦‚ä¸Šå›¾ã€‚é»˜è®¤è„šæœ¬æ–‡ä»¶è·¯å¾„æ˜¯ä»£ç é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„Jenkinsfileã€‚</p>
<p>ä¸‹é¢æ˜¯æˆ‘è¿™é‡Œgitlabå­˜æ”¾çš„ç”¨äºæµ‹è¯•çš„jenkinsfileï¼š</p>
<figure data-type="image" tabindex="19"><img src="https://koko-club.github.io/post-images/jenkins/image-20230216164244800.png" alt="image-20230216164244800" loading="lazy"></figure>
<p>jenkinsfile(pipeline)å’Œjenkinsæµæ°´çº¿é…ç½®å®Œæˆä¹‹åå°±å¯ä»¥æ‰§è¡Œä»»åŠ¡äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡Œçš„gitæ‹‰å–ä»“åº“åªèƒ½å†™åœ¨pipelineä¸­ï¼Œä¸èƒ½åƒè‡ªç”±é£æ ¼å’Œmavené£æ ¼ä»»åŠ¡ä¸€æ ·åœ¨ä»»åŠ¡é…ç½®ä¸­è®¾ç½®æºç ç®¡ç†ï¼ˆgitï¼‰ã€‚è¿™é‡Œé’©å­è§¦å‘çš„é…ç½®å’Œä¸Šé¢ä¸€æ ·ï¼Œä½†æ„å»ºåé€šçŸ¥æ˜¯å†™åœ¨pipelineä¸­çš„ï¼Œä¸‹é¢çš„å¤šåˆ†æ”¯æµæ°´çº¿ä¼šå†™ã€‚</p>
<h5 id="jenkinsä¸­çš„æµæ°´çº¿è¯­æ³•ç”Ÿæˆå™¨">jenkinsä¸­çš„æµæ°´çº¿è¯­æ³•ç”Ÿæˆå™¨</h5>
<p>å¦‚æœä¸ç†Ÿæ‚‰æµæ°´çº¿è¯­æ³•å¯ä»¥åœ¨é…ç½®ä»»åŠ¡ä¸­é€‰æ‹©æµæ°´çº¿è¯­æ³•ï¼Œè·³è½¬åˆ°è¯­æ³•ç”Ÿæˆå™¨ã€‚</p>
<figure data-type="image" tabindex="20"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217104911232.png" alt="image-20230217104911232" loading="lazy"></figure>
<figure data-type="image" tabindex="21"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217104951115.png" alt="image-20230217104951115" loading="lazy"></figure>
<p>ä¾‹å¦‚æˆ‘è¿™é‡Œç”Ÿæˆä¸€ä¸ªgitæ‹‰å–ä»£ç çš„pipelineç‰‡æ®µ</p>
<figure data-type="image" tabindex="22"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217105413932.png" alt="image-20230217105413932" loading="lazy"></figure>
<h4 id="å¤šåˆ†æ”¯æµæ°´çº¿">å¤šåˆ†æ”¯æµæ°´çº¿</h4>
<p>å¤šåˆ†æ”¯æµæ°´çº¿å’Œæµæ°´çº¿ä¸åŒçš„åœ°æ–¹æ˜¯å¤šåˆ†æ”¯æµæ°´çº¿å¯ä»¥ç›´æ¥å¯¹ä¸€ä¸ªé¡¹ç›®å¤šä¸ªåˆ†æ”¯è¿›è¡Œä»»åŠ¡ã€‚åœ¨å®é™…ä¸­ï¼Œéœ€è¦å¤šåˆ†æ”¯åŒæ—¶è¿›è¡Œå¼€å‘ã€‚å¦‚æœæ¯ä¸ªåˆ†æ”¯éƒ½åˆ›å»ºä¸€ä¸ªJenkinsé¡¹ç›®ï¼Œæ¯”è¾ƒå¤šä½™ã€‚ä¸€èˆ¬ä¼ä¸šç”Ÿäº§ä¸­ä¹Ÿä¼šé‡‡ç”¨è¿™ç§æ–¹å¼ã€‚</p>
<figure data-type="image" tabindex="23"><img src="https://koko-club.github.io/post-images/jenkins/63e1c8cfbe940700149b78e776a5f7e0.png" alt="img" loading="lazy"></figure>
<p>æ–°å»ºä»»åŠ¡ä¸­é€‰æ‹©å¤šåˆ†æ”¯æµæ°´çº¿</p>
<figure data-type="image" tabindex="24"><img src="https://koko-club.github.io/post-images/jenkins/image-1607389282641.png" alt="file" loading="lazy"></figure>
<h5 id="åˆ†æ”¯æºé…ç½®">åˆ†æ”¯æºé…ç½®</h5>
<p>å¡«å…¥gité¡¹ç›®åœ°å€ä»¥åŠç™»å½•å‡­æ®ï¼Œæ·»åŠ è¡Œä¸ºclean before/after checkout ç”¨äºæ¸…ç†æœªè·Ÿè¸ªçš„æ–‡ä»¶</p>
<figure data-type="image" tabindex="25"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217101740905.png" alt="image-20230217101740905" loading="lazy"></figure>
<h5 id="build-configuration">build configuration</h5>
<p>å¦‚æœæ˜¯ä»“åº“æ ¹ç›®å½•ä¸‹çš„jenkinsfileå°±ç”¨é»˜è®¤å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é¡¹ç›®ä¸‹éœ€è¦æ‰§è¡Œjenkinsä»»åŠ¡çš„åˆ†æ”¯éƒ½éœ€è¦æœ‰jenkinsfileï¼Œæ¯ä¸ªåˆ†æ”¯çš„jenkinsfileæ˜¯ç‹¬ç«‹çš„ã€‚</p>
<figure data-type="image" tabindex="26"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217101839957.png" alt="image-20230217101839957" loading="lazy"></figure>
<h5 id="æ‰«æ-å¤šåˆ†æ”¯æµæ°´çº¿-è§¦å‘å™¨">æ‰«æ å¤šåˆ†æ”¯æµæ°´çº¿ è§¦å‘å™¨</h5>
<p>å¤šåˆ†æ”¯æµæ°´çº¿é’©å­è§¦å‘å™¨éœ€è¦ä¸‹è½½æ’ä»¶ï¼šMultibranch Scan Webhook Triggerã€‚</p>
<p>å®‰è£…å®Œä»¥ååœ¨æ‰«æ å¤šåˆ†æ”¯æµæ°´çº¿ è§¦å‘å™¨ä¸­é€‰æ‹©scan by webhookï¼Œè¾“å…¥trigger tokenã€‚ä¾‹å¦‚è¿™é‡Œè¾“å…¥çš„æ˜¯testï¼Œåˆ™gitlabé‚£è¾¹è®¾ç½®è§¦å‘é’©å­é…ç½®çš„urlå°±åº”è¯¥æ˜¯</p>
<p>http(s)ğŸ˜•/JENKINS_URL/multibranch-webhook-trigger/invoke?token=test</p>
<figure data-type="image" tabindex="27"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217103028959.png" alt="image-20230217103028959" loading="lazy"></figure>
<p>é…ç½®å®Œä¿å­˜ä»¥åä¼šè‡ªåŠ¨å¼€å§‹æ‰«æå¤šåˆ†æ”¯</p>
<figure data-type="image" tabindex="28"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217103434365.png" alt="image-20230217103434365" loading="lazy"></figure>
<p>ç”±äºæˆ‘è¿™é‡Œæœ‰ä¸¤ä¸ªåˆ†æ”¯mianã€masteré…ç½®äº†jenkinsfileï¼Œåˆ™è¿™ä¸¤ä¸ªåˆ†æ”¯å¯ä»¥æ„å»ºä»»åŠ¡</p>
<figure data-type="image" tabindex="29"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217103520226.png" alt="image-20230217103520226" loading="lazy"></figure>
<figure data-type="image" tabindex="30"><img src="https://koko-club.github.io/post-images/jenkins/image-20230217103531928.png" alt="image-20230217103531928" loading="lazy"></figure>
<p>å¤šåˆ†æ”¯å’Œé’©å­è§¦å‘å™¨éƒ½é…ç½®å®Œæ¯•åï¼Œåœ¨gitä»“åº“é‚£è¾¹å¯¹å¯¹åº”åˆ†æ”¯è¿›è¡Œpushæ“ä½œï¼Œè¿™è¾¹å°±ä¼šè‡ªåŠ¨å¼€å§‹æ„å»ºä»»åŠ¡</p>
<h2 id="å®‰å…¨">å®‰å…¨</h2>
<p>å®‰å…¨é…ç½®ä½äºï¼šç³»ç»Ÿé…ç½®-ã€‹å®‰å…¨å…¨å±€é…ç½®</p>
<h3 id="å‡­æ®">å‡­æ®</h3>
<p>è¿™ä¸ªä¸Šé¢åœ¨gitæ‹‰å–æ—¶å·²ç»ç”¨åˆ°è¿‡äº†ï¼Œå°±ä¸è¯¦ç»†è®²è¿°äº†ã€‚å°±æ˜¯å­˜æ”¾å¯†é’¥æˆ–è€…è´¦å·å¯†ç çš„æ¨¡å—ï¼Œåœ¨ç³»ç»Ÿç®¡ç†-ã€‹å‡­æ®ç®¡ç†ä¸­å¯ä»¥é…ç½®ï¼ˆé…ç½®ä»»åŠ¡æ—¶ä¹Ÿå¯ä»¥ç›´æ¥æ·»åŠ å‡­æ®ï¼‰ã€‚</p>
<h3 id="å®‰å…¨åŸŸ">å®‰å…¨åŸŸ</h3>
<p>å®‰å…¨åŸŸä¸»è¦æ˜¯å®šä¹‰jenkinsç”¨æˆ·çš„æ•°æ®æºï¼Œé»˜è®¤æ˜¯ Jenkinsè‡ªå¸¦çš„ç”¨æˆ·æ•°æ®åº“ã€‚</p>
<p>é…ç½®è·¯å¾„ï¼šjenkinsè®¾ç½®-ã€‹å…¨å±€å®‰å…¨é…ç½®-å®‰å…¨åŸŸ</p>
<p>è¿™ä¸ªä¸€èˆ¬ä½¿ç”¨é»˜è®¤é¡¹å°±è¡Œï¼Œå¦‚æœæœ‰ldapé…ç½®éœ€æ±‚ä¹Ÿå¯ä»¥é€‰æ‹©ldapï¼ˆç”¨æˆ·æ•°æ®ä½¿ç”¨ldapçš„æ•°æ®åº“ï¼‰ã€‚</p>
<h3 id="æˆæƒç­–ç•¥">æˆæƒç­–ç•¥</h3>
<h4 id="ç™»å½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹">ç™»å½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹</h4>
<p>æˆæƒç­–ç•¥é»˜è®¤æ˜¯â€œç™»å½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹â€œï¼Œè¡¨ç¤ºç™»å½•ç”¨æˆ·çš†ä¸ºæœ€é«˜æƒé™ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå­é€‰é¡¹æ˜¯â€åŒ¿åç”¨æˆ·å…·æœ‰å¯è¯»æƒé™â€œï¼Œä¸€èˆ¬ä¼šé…åˆå­é€‰é¡¹è¿›è¡Œä½¿ç”¨ã€‚ï¼ˆç™»å½•çš„æ˜¯ç®¡ç†å‘˜ï¼Œä¸ç™»é™†å°±åªæœ‰åªè¯»æƒé™ï¼‰</p>
<h4 id="ä»»ä½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹æ²¡æœ‰ä»»ä½•é™åˆ¶">ä»»ä½•ç”¨æˆ·å¯ä»¥åšä»»ä½•äº‹(æ²¡æœ‰ä»»ä½•é™åˆ¶)</h4>
<p>ç®€æ˜çŸ¥æ„ï¼Œæ‰€æœ‰ç”¨æˆ·ï¼ˆåŒ…æ‹¬åŒ¿åç”¨æˆ·ï¼‰éƒ½æœ‰æœ€é«˜æƒé™ã€‚ä¸€èˆ¬ä¸ç”¨</p>
<h4 id="å®‰å…¨çŸ©é˜µå’Œé¡¹ç›®çŸ©é˜µæˆæƒç­–ç•¥">å®‰å…¨çŸ©é˜µå’Œé¡¹ç›®çŸ©é˜µæˆæƒç­–ç•¥</h4>
<p>æ ¹æ®ç”¨æˆ·æˆ–ç”¨æˆ·ç»„æˆäºˆå¯¹åº”æƒé™ï¼Œå¯ä»¥ç²¾ç¡®åˆ°å…·ä½“æ¨¡å—æƒé™ï¼Œä½†ä¸€èˆ¬ä¸ä¼šä½¿ç”¨ï¼Œå› ä¸ºæœ‰ä¸€ä¸ªæ›´å¥½çš„æ¨¡å—Role-Based Strategyä½œä¸ºæ›¿ä»£ã€‚</p>
<h4 id="role-based-strategy">Role-Based Strategy</h4>
<p>è§’è‰²æˆæƒæ¨¡å—ï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ç­–ç•¥ï¼Œéœ€è¦å…ˆä¸‹è½½æ¨¡å—<a href="https://plugins.jenkins.io/role-strategy">Role-based Authorization Strategy</a>ã€‚</p>
<p>åº”ç”¨Role-Based Strategyä»¥åï¼Œé€‰æ‹© ç³»ç»Ÿç®¡ç†-ã€‹å®‰å…¨-ã€‹Manage and Assign Roles</p>
<h5 id="ç®¡ç†è§’è‰²">ç®¡ç†è§’è‰²</h5>
<p>ä½äºç³»ç»Ÿç®¡ç†-ã€‹å®‰å…¨-ã€‹Manage and Assign Roles-ã€‹ç®¡ç†è§’è‰²</p>
<p>ç®¡ç†è§’è‰²ä¸»è¦çš„åŠŸèƒ½å°±æ˜¯åˆ›å»ºä¸€ä¸ªè§’è‰²ï¼Œå¹¶å¯¹äºè§’è‰²æˆäºˆæƒé™ï¼Œç„¶åå°†è§’è‰²èµ‹äºˆç”¨æˆ·æˆ–ç”¨æˆ·ç»„</p>
<h6 id="global-roles">Global roles</h6>
<p>å…¨å±€ç®¡ç†ï¼Œå¯ä»¥å¯¹ç”¨æˆ·æˆ–ç»„æˆäºˆæƒé™ï¼ˆè¾“å…¥ç”¨æˆ· addä»¥åé€šè¿‡é€‰æ‹©æ‰“å‹¾æˆäºˆå¯¹åº”æ¨¡å—æƒé™ï¼Œç„¶åä¿å­˜ç”Ÿæ•ˆï¼‰ã€‚<img src="https://koko-club.github.io/post-images/jenkins/image-20230220153651762.png" alt="image-20230220153651762" loading="lazy"></p>
<figure data-type="image" tabindex="31"><img src="https://koko-club.github.io/post-images/jenkins/image-20230220153700562.png" alt="image-20230220153700562" loading="lazy"></figure>
<h6 id="item-roles">Item roles</h6>
<p>é€šè¿‡é¡¹ç›®è¿›è¡Œæˆæƒï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™åŒ¹é…ã€‚ä¾‹å¦‚æˆ‘è¿™é‡Œæ˜¯æˆäºˆæœ‰è‹±æ–‡å­—æ¯a-zçš„é¡¹ç›®æƒé™</p>
<figure data-type="image" tabindex="32"><img src="post-images/jenkins/image-20230220160917798.png" alt="image-20230220160917798" loading="lazy"></figure>
<h6 id="node-roles">Node roles</h6>
<p>Node rolesåœ¨Jenkinsé›†ç¾¤ç¯å¢ƒä¸‹ä½¿ç”¨ï¼Œé…ç½®ä¸åŒç»“ç‚¹çš„Jenkinsæƒé™ã€‚ï¼ˆç›®å‰æ²¡ä½¿ç”¨è¿‡ï¼Œå¦‚åæœŸæœ‰ä½¿ç”¨ä¼šè¡¥ä¸Šè¿™ä¸€å—å†…å®¹ï¼‰</p>
<h5 id="åˆ†é…è§’è‰²">åˆ†é…è§’è‰²</h5>
<p>åˆ†é…è§’è‰²ä¹Ÿæ˜¯ä¸‰å¤§å—ï¼šGlobal rolesã€Item rolesã€Node rolesã€‚åˆ†é…ä¸»è¦å°±æ˜¯æ·»åŠ ç”¨æˆ·ã€ç”¨æˆ·ç»„ç„¶åå‹¾é€‰ä¸Šé¢åˆ›å»ºå¥½çš„è§’è‰²ï¼Œæ­¤æ—¶ç”¨æˆ·ã€ç”¨æˆ·ç»„åˆ™æ‹¥æœ‰äº†è¯¥è§’è‰²çš„æƒé™ã€‚</p>
<p>å¤‡æ³¨ï¼šjenkinsé»˜è®¤æ²¡æœ‰ç»„é€‰é¡¹ï¼Œåªèƒ½é€šè¿‡active directoryæˆ–è€…ldapå¯¹æ¥jenkinsç”¨æˆ·æ•°æ®æ¥ä½¿ç”¨ç”¨æˆ·ç»„ç®¡ç†ã€‚</p>
<h2 id=""></h2>
<h2 id="å…¶ä»–é—®é¢˜">å…¶ä»–é—®é¢˜</h2>
<h3 id="k8sç¯å¢ƒä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜">k8sç¯å¢ƒä¸­å¯èƒ½å‡ºç°çš„é—®é¢˜</h3>
<h4 id="æ—¶åŒº">æ—¶åŒº</h4>
<p>æ—¶åŒºé»˜è®¤è‚¯å®šä¸æ˜¯å›½å†…çš„ï¼Œæœ€ç®€ä¾¿çš„è§£å†³æ–¹æ³•æ˜¯é€šè¿‡æŒ‚è½½ä¸»æœºï¼ˆk8s hostpathæ–¹æ³•ï¼‰çš„æ—¶åŒºæ–‡ä»¶(/etc/localtime)è§£å†³ã€‚æˆ–è€…dockerfileç”¨jenkinsä½œä¸ºåŸºç¡€é•œåƒï¼Œå†åŠ ä¸Šæ—¶åŒºä¿®æ”¹çš„é…ç½®ä¹Ÿå¯ä»¥ã€‚</p>
<h4 id="ä¸­æ–‡ä¹±ç ">ä¸­æ–‡ä¹±ç </h4>
<p>è¿™ä¸ªæ˜¯ä¸æ˜¯k8séƒ½æœ‰å¯èƒ½å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œä¸»è¦æ˜¯ä¸»æœºçš„å­—ç¬¦é›†æ ¼å¼éœ€è¦ä¿®æ”¹ä¸ºä¸­æ–‡utf-8ã€‚å¦‚æœæ˜¯k8sçš„è¯éœ€è¦dockerfileé‡æ–°æ‰“ä¸€ä¸‹é•œåƒï¼Œæ”¹æˆä¸­æ–‡utf-8ï¼Œæˆ–è€…æ¯æ¬¡å¯åŠ¨æ—¶å®‰è£…utf-8ä¸­æ–‡å¹¶é…ç½®ï¼ˆä¸€èˆ¬jenkinsé•œåƒæ²¡æœ‰ä¸­æ–‡utf-8ï¼‰</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ldap]]></title>
        <id>https://koko-club.github.io/post/ldap/</id>
        <link href="https://koko-club.github.io/post/ldap/">
        </link>
        <updated>2023-02-12T16:00:00.000Z</updated>
        <content type="html"><![CDATA[<h1 id="ldap">ldap</h1>
<h2 id="ä»€ä¹ˆæ˜¯ldap">ä»€ä¹ˆæ˜¯ldap</h2>
<pre><code>        é¦–å…ˆLDAPæ˜¯ä¸€ç§é€šè®¯åè®®ï¼ŒLDAPæ”¯æŒTCP/IPã€‚åè®®å°±æ˜¯æ ‡å‡†ï¼Œå¹¶ä¸”æ˜¯æŠ½è±¡çš„ã€‚åœ¨è¿™å¥—æ ‡å‡†ä¸‹ï¼ŒADï¼ˆActive Directoryï¼‰æ˜¯å¾®è½¯å‡ºçš„ä¸€å¥—å®ç°ã€‚
        é‚£ADæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæš‚ä¸”æŠŠå®ƒç†è§£æˆæ˜¯ä¸ªæ•°æ®åº“ã€‚ä¹Ÿæœ‰å¾ˆå¤šäººç›´æ¥æŠŠLDAPè¯´æˆæ•°æ®åº“(å¯ä»¥æŠŠLDAPç†è§£æˆå­˜å‚¨æ•°æ®çš„æ•°æ®åº“)ã€‚åƒæ˜¯å…¶ä»–æ•°æ®åº“ä¸€æ ·ï¼ŒLDAPä¹Ÿæ˜¯æœ‰clientç«¯å’Œserverç«¯ã€‚serverç«¯æ˜¯ç”¨æ¥å­˜æ”¾èµ„æºï¼Œclientç«¯ç”¨æ¥æ“ä½œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œã€‚
        è€Œæˆ‘ä»¬é€šå¸¸è¯´çš„LDAPæ˜¯æŒ‡è¿è¡Œè¿™ä¸ªæ•°æ®åº“çš„æœåŠ¡å™¨ã€‚
        å¯ä»¥ç®€å•ç†è§£AD =LDAPæœåŠ¡å™¨ï¼‹LDAPåº”ç”¨ã€‚
</code></pre>
<h2 id="ç”¨é€”">ç”¨é€”</h2>
<pre><code>ç”¨äºç»Ÿä¸€è®¤è¯ç®¡ç†ï¼Œç»Ÿä¸€å…¬å¸å†…éƒ¨æœåŠ¡è´¦å·å¯†ç ã€‚
</code></pre>
<h2 id="ldap-æ¨¡å‹">LDAP æ¨¡å‹</h2>
<h3 id="åŸºæœ¬æ¨¡å‹">åŸºæœ¬æ¨¡å‹</h3>
<pre><code>ç›®å½•æ ‘ï¼šåœ¨ä¸€ä¸ªç›®å½•æœåŠ¡ç³»ç»Ÿä¸­ï¼Œæ•´ä¸ªç›®å½•ä¿¡æ¯é›†å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªç›®å½•ä¿¡æ¯æ ‘ï¼Œæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æ˜¯ä¸€ä¸ªæ¡ç›®ã€‚
æ¡ç›®ï¼šæ¯ä¸ªæ¡ç›®å°±æ˜¯ä¸€æ¡è®°å½•ï¼Œæ¯ä¸ªæ¡ç›®æœ‰è‡ªå·±çš„å”¯ä¸€å¯åŒºåˆ«çš„åç§°ï¼ˆDNï¼‰ã€‚
å¯¹è±¡ç±»ï¼šæ˜¯æŸä¸ªå®ä½“ç±»å‹å¯¹åº”çš„ä¸€ç»„å±æ€§ï¼Œå¯¹è±¡ç±»å¯ä»¥ç»§æ‰¿ï¼Œçˆ¶ç±»çš„å¿…é¡»å±æ€§ä¹Ÿä¼šè¢«ç»§æ‰¿ä¸‹æ¥ã€‚
å±æ€§ï¼šæè¿°æ¡ç›®çš„æŸä¸ªæ–¹é¢çš„ä¿¡æ¯ï¼Œä¸€ä¸ªå±æ€§ç”±ä¸€ä¸ªå±æ€§ç±»å‹å’Œä¸€ä¸ªæˆ–å¤šä¸ªå±æ€§å€¼ç»„æˆï¼Œå±æ€§æœ‰å¿…é¡»å±æ€§å’Œéå¿…é¡»å±æ€§ã€‚

</code></pre>
<table>
<thead>
<tr>
<th><strong>å…³é”®å­—</strong></th>
<th><strong>è‹±æ–‡å…¨ç§°</strong></th>
<th><strong>å«ä¹‰</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>dc</strong></td>
<td>Domain Component</td>
<td>åŸŸåçš„éƒ¨åˆ†ï¼Œå…¶æ ¼å¼æ˜¯å°†å®Œæ•´çš„åŸŸååˆ†æˆå‡ éƒ¨åˆ†ï¼Œå¦‚åŸŸåä¸ºexample.comå˜æˆdc=example,dc=comï¼ˆä¸€æ¡è®°å½•çš„æ‰€å±ä½ç½®ï¼‰</td>
</tr>
<tr>
<td><strong>uid</strong></td>
<td>User Id</td>
<td>ç”¨æˆ·ID songtao.xuï¼ˆä¸€æ¡è®°å½•çš„IDï¼‰</td>
</tr>
<tr>
<td><strong>ou</strong></td>
<td>Organization Unit</td>
<td>ç»„ç»‡å•ä½ï¼Œç»„ç»‡å•ä½å¯ä»¥åŒ…å«å…¶ä»–å„ç§å¯¹è±¡ï¼ˆåŒ…æ‹¬å…¶ä»–ç»„ç»‡å•å…ƒï¼‰ï¼Œå¦‚â€œoaç»„â€ï¼ˆä¸€æ¡è®°å½•çš„æ‰€å±ç»„ç»‡ï¼‰</td>
</tr>
<tr>
<td><strong>cn</strong></td>
<td>Common Name</td>
<td>å…¬å…±åç§°ï¼Œå¦‚â€œThomas Johanssonâ€ï¼ˆä¸€æ¡è®°å½•çš„åç§°ï¼‰</td>
</tr>
<tr>
<td><strong>sn</strong></td>
<td>Surname</td>
<td>å§“ï¼Œå¦‚â€œè®¸â€</td>
</tr>
<tr>
<td><strong>dn</strong></td>
<td>Distinguished Name</td>
<td>â€œuid=songtao.xu,ou=oaç»„,dc=example,dc=comâ€ï¼Œä¸€æ¡è®°å½•çš„ä½ç½®ï¼ˆå”¯ä¸€ï¼‰</td>
</tr>
<tr>
<td><strong>rdn</strong></td>
<td>Relative dn</td>
<td>ç›¸å¯¹è¾¨åˆ«åï¼Œç±»ä¼¼äºæ–‡ä»¶ç³»ç»Ÿä¸­çš„ç›¸å¯¹è·¯å¾„ï¼Œå®ƒæ˜¯ä¸ç›®å½•æ ‘ç»“æ„æ— å…³çš„éƒ¨åˆ†ï¼Œå¦‚â€œuid=tomâ€æˆ–â€œcn= Thomas Johanssonâ€</td>
</tr>
</tbody>
</table>
<pre><code>dn ï¼šä¸€æ¡è®°å½•çš„è¯¦ç»†ä½ç½®ã€‚ç›®å½•ä½ç½®
dc ï¼šä¸€æ¡è®°å½•æ‰€å±åŒºåŸŸ (å“ªä¸€é¢—æ ‘)ã€‚æ ¹åç§°
ou ï¼šä¸€æ¡è®°å½•æ‰€å±ç»„ç»‡ ï¼ˆå“ªä¸€ä¸ªåˆ†æ”¯ï¼‰ã€‚ç»„åç§°
cn/uidï¼šä¸€æ¡è®°å½•çš„åå­—/ID (å“ªä¸€ä¸ªè‹¹æœåå­—)ã€‚ç”¨æˆ·åç§°
</code></pre>
<figure data-type="image" tabindex="1"><img src="https://koko-club.github.io/post-images/ldap/ldap_tree.png" alt="img" loading="lazy"></figure>
<h3 id="ä¿¡æ¯æ¨¡å‹">ä¿¡æ¯æ¨¡å‹</h3>
<p>LDAPä¸­ï¼Œä¿¡æ¯ä»¥æ ‘çŠ¶æ–¹å¼è¿›è¡Œç»„ç»‡çš„ï¼Œåœ¨æ ‘çŠ¶ä¿¡æ¯ä¸­çš„åŸºæœ¬æ•°æ®å•å…ƒæ˜¯æ¡ç›®ï¼Œè€Œæ¯ä¸ªæ¡ç›®ç”±å±æ€§æ„æˆï¼Œå±æ€§ä¸­å­˜å‚¨æœ‰å±æ€§å€¼;</p>
<h3 id="å‘½åæ¨¡å‹">å‘½åæ¨¡å‹</h3>
<p>å³LDAPä¸­çš„æ¡ç›®å®šä½æ–¹å¼ï¼Œåœ¨LDAPä¸­æ¯ä¸ªæ¡ç›®å‡æœ‰è‡ªå·±çš„DNã€‚<br>
DNæ˜¯è¯¥æ¡ç›®åœ¨æ•´ä¸ªæ ‘ä¸­çš„å”¯ä¸€åç§°æ ‡è¯†ï¼Œ</p>
<p>å¦‚åŒæ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œå¸¦è·¯å¾„çš„æ–‡ä»¶åå°±æ˜¯DNã€‚</p>
<h3 id="åŠŸèƒ½æ¨¡å‹">åŠŸèƒ½æ¨¡å‹</h3>
<p>åœ¨LDAPä¸­å…±æœ‰å››ç±»10ç§æ“ä½œï¸°<br>
æŸ¥è¯¢ç±»æ“ä½œï¼šå¦‚æœç´¢ã€æ¯”è¾ƒ;<br>
æ›´æ–°ç±»æ“ä½œï¼šå¦‚æ·»åŠ æ¡ç›®ã€åˆ é™¤æ¡ç›®ã€ä¿®æ”¹æ¡ç›®ã€ä¿®æ”¹æ¡ç›®å;<br>
è®¤è¯ç±»æ“ä½œï¼šå¦‚ç»‘å®šã€è§£ç»‘å®š;<br>
å…¶å®ƒæ“ä½œï¼šå¦‚æ”¾å¼ƒå’Œæ‰©å±•æ“ä½œã€‚</p>
<p>é™¤äº†æ‰©å±•æ“ä½œï¼Œå¦å¤–9ç§æ˜¯LDAPçš„æ ‡å‡†æ“ä½œï¹”</p>
<p>æ‰©å±•æ“ä½œæ˜¯LDAPä¸­ä¸ºäº†å¢åŠ æ–°çš„åŠŸèƒ½ï¼Œæä¾›çš„ä¸€ç§æ ‡å‡†çš„æ‰©å±•æ¡†æ¶ï¼Œå½“å‰å·²ç»æˆä¸ºLDAPæ ‡å‡†çš„æ‰©å±•æ“ä½œï¼Œæœ‰ä¿®æ”¹å¯†ç å’ŒstartTLSæ‰©å±•ï¼Œ</p>
<p>åœ¨æ–°çš„RFCæ ‡å‡†å’Œè‰æ¡ˆä¸­æ­£åœ¨å¢åŠ ä¸€äº›æ–°çš„æ‰©å±•æ“ä½œï¼Œä¸åŒçš„LDAPå‚å•†ä¹Ÿå‡å®šä¹‰äº†è‡ªå·±çš„æ‰©å±•æ“ä½œã€‚</p>
<h3 id="å®‰å…¨æ¨¡å‹">å®‰å…¨æ¨¡å‹</h3>
<p>å®‰å…¨æ¨¡å‹ä¸»è¦é€šè¿‡èº«ä»½è®¤è¯ã€å®‰å…¨é€šé“å’Œè®¿é—®æ§åˆ¶æ¥å®ç°ã€‚</p>
<h1 id="ldap-server">ldap server</h1>
<p>ä¸€èˆ¬ldapæœåŠ¡ç«¯æ¯”è¾ƒå¸¸ç”¨çš„æ˜¯openldapï¼Œè¿™é‡Œä»…è®°å½•openldapçš„éƒ¨ç½²åŠä½¿ç”¨ã€‚</p>
<h2 id="openldap">openldap</h2>
<h3 id="k8séƒ¨ç½²">k8séƒ¨ç½²</h3>
<p>ç›´æ¥ç”¨yamléƒ¨ç½²å°±è¡Œï¼Œé•œåƒç”¨çš„æ˜¯bitnamiçš„ldapé•œåƒ</p>
<pre><code>apiVersion: apps/v1
kind: Deployment
metadata:
  name: openldap
spec:
  replicas: 1
  selector:
    matchLabels:
      app: openldap
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      labels:
        app: openldap
    spec:
      containers:
      - env:
        - name: LDAP_ADMIN_USERNAME
          value: admin
        - name: LDAP_ADMIN_PASSWORD
          value: &quot;123456&quot;
        - name: LDAP_USERS
          value: manager
        - name: LDAP_PASSWORDS
          value: &quot;123456&quot;
        - name: LDAP_ROOT
          value: dc=finsiot,dc=com
        image: bitnami/openldap:latest
        imagePullPolicy: Always
        name: openldap
        ports:
        - containerPort: 1389
          name: service
          protocol: TCP
        resources:
          limits:
            cpu: &quot;1&quot;
            memory: 2Gi
          requests:
            cpu: &quot;1&quot;
            memory: 2Gi
        volumeMounts:
        - mountPath: /bitnami/openldap/data
          name: openldap-pvc
          subPath: ldap
        - mountPath: /bitnami/openldap/slapd.d
          name: openldap-pvc
          subPath: slapd.d
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      schedulerName: default-scheduler
      securityContext: {}
      terminationGracePeriodSeconds: 30
      volumes:
      - name: openldap-pvc
        persistentVolumeClaim:
          claimName: ldap-pvc
---

apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: ldap-pvc
  labels:
    app: ldap
spec:
  storageClassName: csi-rbd-sc   #è¿™é‡Œçš„storageclassæ˜¯æˆ‘ä»¬ä¹‹å‰ç”³è¯·çš„
  accessModes:
  - ReadWriteOnce
  resources:
    requests:
      storage: 2Gi
---
apiVersion: v1
kind: Service
metadata:
  name: openldap
spec:
  #clusterIP: 192.168.110.29
  #externalTrafficPolicy: Cluster
  ports:
  - nodePort: 30300
    port: 1389
    protocol: TCP
    targetPort: service
  selector:
    app: openldap
  sessionAffinity: None
  type: NodePort
status:
  loadBalancer: {}
</code></pre>
<h3 id="ldapäºŒè¿›åˆ¶éƒ¨ç½²">ldapäºŒè¿›åˆ¶éƒ¨ç½²</h3>
<p>è¿™é‡Œæ²¡æœ‰å°è¯•è¿‡äºŒè¿›åˆ¶éƒ¨ç½²ldapï¼Œåé¢ä¼šå†™ã€‚</p>
<h3 id="ldapç®¡ç†">ldapç®¡ç†</h3>
<p>ç®¡ç†æ“ä½œldapæ•°æ®å¯ä»¥ä½¿ç”¨ldapå®¢æˆ·ç«¯æˆ–è€…ldapç®¡ç†æœåŠ¡å·¥å…·å®ç°ã€‚å¦‚æœä½¿ç”¨ldap windowså®¢æˆ·ç«¯å¯ä»¥ä¸‹è½½LDAPSoft Ldap Browserä½¿ç”¨ï¼Œå¦‚æœä½¿ç”¨ç®¡ç†webé¡µé¢å¯ä»¥éƒ¨ç½²æœåŠ¡ï¼šldapphpadminã€‚</p>
<h2 id="ldapphpadmin">ldapphpadmin</h2>
<h3 id="k8séƒ¨ç½²-2">k8séƒ¨ç½²</h3>
<pre><code>
apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    kompose.cmd: kompose convert -f docker-compose.yml
    kompose.version: 1.16.0 (0c01309)
  creationTimestamp: null
  labels:
    io.kompose.service: phpldapadmin
  name: phpldapadmin
spec:
  replicas: 1
  strategy: {}
  selector:                #å®šä¹‰é€‰æ‹©å™¨
    matchLabels:           #åŒ¹é…ä¸Šé¢çš„æ ‡ç­¾
        io.kompose.service: phpldapadmin         #åŒ¹é…æ¨¡æ¿åç§°
  template:
    metadata:
      creationTimestamp: null
      labels:
        io.kompose.service: phpldapadmin
    spec:
      containers:
      - env:
        - name: PHPLDAPADMIN_HTTPS
          value: &quot;false&quot;
        - name: PHPLDAPADMIN_LDAP_HOSTS
          value: 'ldap://192.168.110.29:30389'
        image: osixia/phpldapadmin:0.7.1
        name: phpldapadmin
        ports:
        - containerPort: 80
        resources: {}
      restartPolicy: Always
---
apiVersion: v1
kind: Service
metadata:ZZ
  labels:
    io.kompose.service: phpldapadmin
  name: phpldapadmin
spec:
  ports:
  - name: &quot;8080&quot;
    port: 8080
    targetPort: 80
  selector:
    io.kompose.service: phpldapadmin
</code></pre>
<h1 id="ldap-for-nexus">ldap for nexus</h1>
<p>æœ¬æ–‡ä¸»è¦ä¸ºnexusé›†æˆåˆ°ldapçš„é…ç½®ï¼Œç”±äºç½‘ä¸Šå…³äºè¯¥åŠŸèƒ½çš„é…ç½®å¤§éƒ½å±‚æ¬¡ä¸é½ä¸”å†™çš„å¤ªæ¨¡ç³Šï¼Œæ•…è®°å½•æ­¤æ–‡æ¡£ã€‚</p>
<h2 id="1-ldapé…ç½®">1ã€ldapé…ç½®</h2>
<p>è¿™é‡Œldapç”¨çš„æ˜¯openldapï¼Œæ‰€ä»¥é¦–å…ˆéœ€è¦éƒ¨ç½²å¥½openldapã€‚é¦–å…ˆæƒ³è¦åœ¨nexusä¸­é›†æˆldapï¼Œldapçš„æœåŠ¡ç«¯å¿…é¡»è¦æœ‰ç»„å’Œç”¨æˆ·ã€‚</p>
<pre><code>è¿™é‡Œçš„ç»„ç”¨æ¥æ˜ å°„ä¸nexusçš„è§’è‰²ï¼Œä½¿å…¶ç»„ä¸‹é¢çš„ç”¨æˆ·éƒ½æ‹¥æœ‰nexusæ˜ å°„è§’è‰²çš„æƒé™ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚
è¿™é‡Œçš„ç”¨æˆ·åˆ™ç”¨æ¥ç™»å½•nexusã€‚
</code></pre>
<p>æ‰€ä»¥éœ€è¦åˆ›å»ºå¥½ç»„å’Œç”¨æˆ·ï¼Œè¿™é‡Œä»¥æ˜ å°„ä¸€ä¸ªnexusç®¡ç†å‘˜ä¸ºä¾‹å­ï¼Œé¦–å…ˆåˆ›å»ºå‡†å¤‡å¥½ldapçš„ç”¨æˆ·å’Œç»„ï¼š</p>
<pre><code>åˆ›å»ºä¸€ä¸ªouä¸ºnexusï¼Œç»„ä¸ºmanagerï¼Œç”¨æˆ·ä¸ºnexusï¼Œå…ˆåˆ›å»ºç»„ï¼Œç„¶ååˆ›å»ºç”¨æˆ·æŒ‡å®šç»„ã€‚
ç»„:cn=manager,ou=nexus,dc=finsiot,dc=com
ç”¨æˆ·:cn=nexus,ou=nexus,dc=finsiot,dc=com
</code></pre>
<figure data-type="image" tabindex="2"><img src="https://koko-club.github.io/post-images/ldap/image-20221110171353237.png" alt="image-20221110171353237" loading="lazy"></figure>
<h2 id="2-nexusé…ç½®">2ã€nexusé…ç½®</h2>
<pre><code>	1.è®¿é—®nexus-webç®¡ç†é¡µé¢ï¼Œç™»å½•ç®¡ç†å‘˜è´¦å·ï¼Œè¿›å…¥è®¾ç½®-ã€‹secruity-ã€‹LDAP-ã€‹create connection
	2.connectioné…ç½®ï¼š
		nameï¼šè¿™ä¸ªæ˜¯è¦åˆ›å»ºçš„ldapåç§°ï¼Œå¯ä»¥éšä¾¿å¡«ï¼Œéå…³é”®æ€§å‚æ•°ã€‚
		Ldap server address:å¡«å…¥ldapåœ°å€
		Search base Dn:å¡«å…¥dnåœ°å€ï¼ˆdcçš„åœ°å€ï¼‰
		Authentication method: Simple Authentication
		Username or DN: å¡«å…¥ç™»å½•ç”¨æˆ·å(ä¸€èˆ¬ç”¨adminç®¡ç†å‘˜ç™»å½•)
		password: å¯†ç 
	3.User and groupé…ç½®ï¼š
		configuration template: é€‰æ‹©ä¸€ä¸ªæ¨¡æ¿ï¼Œéå…³é”®æ€§å‚æ•°ï¼Œåªæ˜¯ä¼šé¢„å…ˆç»™å‡ºä¸‹é¢ä¸€äº›å‚æ•°çš„å€¼ã€‚è¿™é‡Œå¯ä»¥é€‰posix with static groups
		user relative dn(base dn):å¯¹åº”äºç”¨ä½œç”¨æˆ·æ¡ç›®åŸºç¡€çš„ä¸“æœ‰åç§°é›†åˆã€‚æ­¤DNä¸å‰é¢çš„search baseç›¸å…³ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·éƒ½åŒ…å«åœ¨ou = nexusï¼Œdc=finsiot,dc=comä¸­ï¼Œå‰é¢ç™»å½•æ—¶æŒ‡å®šäº†dc=finsiot,dc=comçš„æœç´¢åº“ï¼Œåˆ™è¿™é‡Œä½¿ç”¨å€¼ou = nexusã€‚
		User subtreeï¼šÂ å¦‚æœåŸºæœ¬DNä¸‹é¢çš„æ ‘å¯ä»¥åŒ…å«ç”¨æˆ·æ¡ç›®ï¼Œåˆ™å€¼ä¸ºtrue;å¦‚æœæ‰€æœ‰ç”¨æˆ·éƒ½åŒ…å«åœ¨æŒ‡å®šçš„åŸºæœ¬DNä¸­ï¼Œåˆ™ä¸ºfalseã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‰€æœ‰ç”¨æˆ·éƒ½åœ¨ou = usersï¼Œdc = sonatypeï¼Œdc = comï¼Œåˆ™æ­¤å­—æ®µåº”ä¸ºFalseã€‚å¦‚æœç”¨æˆ·å¯ä»¥åœ¨ç»„ç»‡å•ä½å†…çš„ç»„ç»‡å•ä½ä¸­æ˜¾ç¤ºï¼Œä¾‹å¦‚ou = developmentï¼Œou = usersï¼Œdc = sonatypeï¼Œdc = comï¼Œåˆ™æ­¤å­—æ®µåº”ä¸ºTrueã€‚
		Object classï¼š æ­¤å€¼æ˜¯RFC-2798ä¸­å®šä¹‰çš„æ ‡å‡†å¯¹è±¡ç±»ã€‚å®ƒä¸ºç”¨æˆ·æŒ‡å®šå¯¹è±¡ç±»ã€‚å¸¸è§å€¼ä¸ºinetOrgPersonï¼Œpersonï¼Œuseræˆ–posixAccountã€‚è¿™é‡Œä½¿ç”¨æ¨¡æ¿é»˜è®¤çš„posixAccount
		User filterï¼š è¿™å…è®¸æ‚¨é…ç½®è¿‡æ»¤å™¨ä»¥é™åˆ¶å¯¹ç”¨æˆ·è®°å½•çš„æœç´¢ã€‚å®ƒå¯ä»¥ç”¨ä½œæ€§èƒ½æ”¹è¿›ã€‚è¿™é‡Œä¸ç”¨å¡«å†™ã€‚
		User ID attributeï¼š è¿™æ˜¯ä¸Šé¢æŒ‡å®šçš„å¯¹è±¡ç±»çš„å±æ€§ï¼Œå®ƒä»LDAPæœåŠ¡å™¨æä¾›ç”¨æˆ·çš„æ ‡è¯†ç¬¦ã€‚å­˜å‚¨åº“ç®¡ç†å™¨ä½¿ç”¨æ­¤å±æ€§ä½œä¸ºç”¨æˆ·IDå€¼ã€‚åœ¨ldapåˆ›å»ºäº†ç”¨æˆ·ä»¥åï¼Œé‡Œé¢æœ‰ä¸€ä¸ªå±æ€§å€¼ï¼ˆé»˜è®¤ä¸ºuidï¼‰ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œåˆ›å»ºäº†ä¸€ä¸ªnexusçš„ç”¨æˆ·ï¼Œåˆ™ä¼šæœ‰ä¸€ä¸ªuidçš„å€¼ä¸ºnexusï¼ŒnexusæœåŠ¡éœ€è¦é€šè¿‡è¿™ä¸ªkey:valueæ¥æ‰¾åˆ°è¯¥ç”¨æˆ·
		Real name attributeï¼š è¿™æ˜¯Objectç±»çš„å±æ€§ï¼Œå®ƒæä¾›ç”¨æˆ·çš„çœŸå®å§“åã€‚å­˜å‚¨åº“ç®¡ç†å™¨åœ¨éœ€è¦æ˜¾ç¤ºç”¨æˆ·çš„çœŸå®å§“åæ—¶ä½¿ç”¨æ­¤å±æ€§ï¼Œç±»ä¼¼äºå†…éƒ¨åå­—å’Œå§“æ°å±æ€§çš„ä½¿ç”¨ã€‚è¿™ä¸ªä¹Ÿæ˜¯å»æ‰¾ldapé‡Œé¢çš„kvå±æ€§ï¼Œé»˜è®¤æ˜¯keyçš„åç§°ä¸ºcnã€‚
		Email attribute: åŒä¸Šé¢çš„User ID attributeå’ŒReal name attributeï¼Œé»˜è®¤keyçš„åç§°ä¸ºmailã€‚
		Password attribute:ä¸ç”¨å¡«å†™ï¼Œè¿™é‡Œä¸ºç©ºåˆ™ä¼šåœ¨ç™»å½•æ—¶è¯»å–ldapä¸­ç”¨æˆ·çš„passwordå­—æ®µã€‚
		Map LDAP groups as rolesï¼šè¿™é‡Œéœ€è¦å‹¾é€‰ï¼Œä¸‹é¢æ˜¯ç»„çš„é…ç½®ï¼Œç”¨äºå°†ldapç»„æ˜ å°„äºnexusã€‚
		Group type: static Groups è¿™é‡Œé€‰æ‹©é™æ€ç»„
		Group relative DN: æŒ‡åç»„çš„DNä½ç½®ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œmanagerç»„åœ¨nexusä¸‹é¢ï¼Œåˆ™è¿™é‡Œå¡«ou=nexusã€‚
		Group subtree: å‹¾é€‰ï¼Œè¡¨ç¤ºæ˜¯ä½äºgroupä¸‹é¢çš„å­ç»„ã€‚ä¾‹å¦‚æˆ‘ä¸Šé¢ou=nexusï¼Œåˆ™è¿™é‡Œå‹¾é€‰çš„æ„æ€æ˜¯nexusä¸‹é¢çš„ç»„ã€‚
		Group object class: ç»„åˆ›å»ºæ—¶ä¼šæœ‰è¿™ä¸ªå­—æ®µï¼Œé»˜è®¤ä¸ºposixGroupã€‚å’Œä¸Šé¢å®šä¹‰User ID attributeå’ŒReal name attributeå’ŒEmail attributeæ˜¯ä¸€æ ·çš„ã€‚
		Group ID attributeï¼š è¿™é‡Œè¡¨ç¤ºç»„çš„idå±æ€§ï¼Œå’Œä¸Šé¢å®šä¹‰User ID attributeå’ŒReal name attributeå’ŒEmail attributeæ˜¯ä¸€æ ·çš„ã€‚
		Group member attribute: è¿™é‡Œè¡¨ç¤ºç»„é‡Œé¢æœ‰å“ªäº›æˆå‘˜ï¼Œå’Œä¸Šé¢ä¸¤ä¸ªå±æ€§ä¸€æ ·ï¼Œä¹Ÿæ˜¯ldapç»„ä¸­çš„å­—æ®µï¼Œä½†é»˜è®¤ä¸ä¼šåˆ›å»ºè¿™ä¸ªå­—æ®µï¼Œè¯·æ‰‹åŠ¨åˆ›å»ºmemberUidçš„å­—æ®µå¹¶æŠŠæˆå‘˜çš„å­—æ®µå€¼å†™å…¥è¯¥å­—æ®µï¼Œå¦åˆ™ä¼šæ‰¾ä¸åˆ°æ˜ å°„çš„è§’è‰²ã€‚
		Group member format: è¯¥å­—æ®µç”¨æ¥æ‰¾åˆ°memberUidä¸­çš„ç»„å‘˜åç§°çš„ï¼Œä½¿ç”¨å˜é‡${username}ã€‚
</code></pre>
<figure data-type="image" tabindex="3"><img src="https://koko-club.github.io/post-images/ldap/image-20221110171338946.png" alt="image-20221110171338946" loading="lazy"></figure>
<figure data-type="image" tabindex="4"><img src="https://koko-club.github.io/post-images/ldap/image-20221110171215302.png" alt="image-20221110171215302" loading="lazy"></figure>
<figure data-type="image" tabindex="5"><img src="https://koko-club.github.io/post-images/ldap/image-20221110171237900.png" alt="image-20221110171237900" loading="lazy"></figure>
<figure data-type="image" tabindex="6"><img src="https://koko-club.github.io/post-images/ldap/image-20221110171249864.png" alt="image-20221110171249864" loading="lazy"></figure>
<h3 id="åˆ›å»ºè§’è‰²">åˆ›å»ºè§’è‰²</h3>
<p>åœ¨nexusè®¾ç½®-ã€‹security-ã€‹rolesä¸­æ·»åŠ ä¸€ä¸ªroleï¼Œtypeä¸ºexternal role mappingï¼Œexternal role typeä¸ºldapã€‚</p>
<figure data-type="image" tabindex="7"><img src="https://koko-club.github.io/post-images/ldap/image-20221110171612944.png" alt="image-20221110171612944" loading="lazy"></figure>
<pre><code>Mapped Roleï¼šè¯·å¡«å†™ä¸ºldapä¸­åˆ›å»ºçš„ç»„åç§°ï¼Œä¸¤ä¸ªæœåŠ¡ä¼šé€šè¿‡åç§°è¿›è¡Œæ˜ å°„ï¼Œä¾‹å¦‚æˆ‘è¿™é‡Œldapä¸­æœ‰ä¸€ä¸ªnexusç”¨æˆ·ï¼Œåœ¨managerç»„ä¸‹é¢ï¼Œäºæ˜¯è¿™é‡Œæˆ‘å®šä¹‰ä¸€ä¸ªmapped roleä¸ºmanagerï¼Œåˆ™nexusä»¥åŠldapä¸­managerç»„ä¸­æ‰€æœ‰ç”¨æˆ·éƒ½ä¼šæ‹¥æœ‰è¿™é‡Œå®šä¹‰å¥½çš„æƒé™ï¼Œä¹Ÿå°±æ˜¯ç»„æƒé™æ˜ å°„ã€‚
Role Nameï¼š roleè§’è‰²çš„åç§°ã€‚
Role Descriptionï¼š è§’è‰²ä»‹ç»ã€‚
Privilegesï¼šå®šä¹‰çš„æ˜¯è§’è‰²çš„æƒé™ã€‚
Rolesï¼šå¯ä»¥ä¸å…¶å®ƒå®šä¹‰å¥½çš„roleå…³è”æƒé™ã€‚
</code></pre>
<h3 id="æµ‹è¯•">æµ‹è¯•</h3>
<p>åˆ›å»ºå¥½ä»¥åå›åˆ°åˆšåˆšçš„ldapè®¾ç½®ï¼Œç‚¹å‡»åˆšåˆšåˆ›å»ºçš„ldapï¼Œè¿›å…¥user and groupè®¾ç½®ï¼Œæœ€ä¸‹æ–¹æœ‰ä¸€ä¸ª verify user mapping ã€‚</p>
<figure data-type="image" tabindex="8"><img src="https://koko-club.github.io/post-images/ldap/image-20221110171936912.png" alt="image-20221110171936912" loading="lazy"></figure>
<p>ç‚¹å‡»å±äºldapå¯†ç å°±å¯ä»¥çœ‹åˆ°ç›®å‰å®šä¹‰æ˜ å°„çš„ç»„å’Œç”¨æˆ·æƒ…å†µ</p>
<figure data-type="image" tabindex="9"><img src="https://koko-club.github.io/post-images/ldap/image-20221110172056058.png" alt="image-20221110172056058" loading="lazy"></figure>
<p>è¿™é‡Œuser idå…¶å®å°±æ˜¯ä¸Šé¢user id attributeé…ç½®ï¼Œnameä¸ºReal name attributeé…ç½®ï¼Œemailä¸ºEmail attributeï¼Œrolesæ˜¯Map LDAP groups as rolesåŠä¸‹é¢æ‰€æœ‰ç»„é…ç½®å®šä¹‰çš„ã€‚å¦‚æœæœ‰æ²¡æœ‰æ•°æ®çš„å­—æ®µï¼Œè¯·æ£€æŸ¥è¯¥é¡¹å¯¹åº”é…ç½®çš„å­—æ®µæ˜¯å¦æ­£å¸¸é…ç½®ï¼Œä¾‹å¦‚å¦‚æœrolesæ²¡æœ‰ï¼Œè¯·çœ‹ä¸€ä¸‹Map LDAP groups as rolesä¸‹é¢çš„é…ç½®æ˜¯å¦æ­£ç¡®ã€‚</p>
<h1 id="ldap-for-jenkins">ldap for jenkins</h1>
<p>jenkinsé›†æˆldapçš„æ–¹æ³•</p>
<h2 id="1-å®‰è£…æ’ä»¶">1ã€å®‰è£…æ’ä»¶</h2>
<figure data-type="image" tabindex="10"><img src="https://koko-club.github.io/post-images/ldap/cb436a8c487d4df0b47bfea2f494bf77.png" alt="Jenkinså®‰è£…LDAPæ’ä»¶" loading="lazy"></figure>
<h2 id="2-é…ç½®ldap">2ã€é…ç½®ldap</h2>
<p>è¿›å…¥ç®¡ç†è®¾ç½®ï¼ˆmanage jenkinsï¼‰-&gt;å…¨å±€å®‰å…¨è®¾ç½®(configure global security),è®¾ç½®å®‰å…¨åŸŸä¸ºldap</p>
<figure data-type="image" tabindex="11"><img src="https://koko-club.github.io/post-images/ldap/image-20230210101753775.png" alt="image-20230210101753775" loading="lazy"></figure>
<h3 id="é…ç½®é¡¹">é…ç½®é¡¹</h3>
<pre><code>Serverï¼šldapçš„åœ°å€url
root DNï¼šæ ¹DNç›®å½•è·¯å¾„
User search baseï¼šæŸ¥æ‰¾ç”¨æˆ·çš„ç›®å½•
User search filterï¼šæŸ¥æ‰¾ç”¨æˆ·çš„æ¡ä»¶
Group search baseï¼š æŸ¥æ‰¾ç”¨æˆ·ç»„çš„ç›®å½•
Group search filterï¼š ç”¨æˆ·ç»„æ¡ä»¶(æŸ¥æ‰¾ç”¨æˆ·çš„æ¡ä»¶)
Group membershipï¼šé€‰æ‹© Search for LDAP groups containing user
Manager DNï¼š ç®¡ç†å‘˜æ‰€åœ¨è·¯å¾„
Manager Passwordï¼š ç®¡ç†å‘˜å¯†ç 
Display Name LDAP attributeï¼š jenkinså¯¹åº”ldapç”¨æˆ·åçš„å­—æ®µ
Email Address LDAP attributeï¼šemailå­—æ®µ
</code></pre>
<p>é…ç½®ç¤ºä¾‹ï¼š</p>
<figure data-type="image" tabindex="12"><img src="https://koko-club.github.io/post-images/ldap/image-20230210102814010.png" alt="image-20230210102814010" loading="lazy"></figure>
<p>è¿™é‡Œldapçš„ç»“æ„ä¸ºï¼Œç”¨æˆ·ç›®å½•ï¼šou=people,dc=xxx,dc=comï¼Œç”¨æˆ·ç»„ç›®å½•ï¼šou=group,dc=xxx,dc=com</p>
<figure data-type="image" tabindex="13"><img src="https://koko-club.github.io/post-images/ldap/image-20230210103422255.png" alt="image-20230210103422255" loading="lazy"></figure>
<figure data-type="image" tabindex="14"><img src="https://koko-club.github.io/post-images/ldap/image-20230210103437606.png" alt="image-20230210103437606" loading="lazy"></figure>
<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼šuser search filterç”¨äºæ‰¾åˆ°ç”¨æˆ·ï¼Œå¦‚æœè¿™é‡Œå¡«é”™äº†å°†ä¼šæ‰¾ä¸åˆ°ç”¨æˆ·ã€‚group search baseåˆ™æ˜¯ç”¨äºæ‰¾åˆ°ç”¨æˆ·ç»„ï¼Œå¦‚æœè¿™é‡Œå¡«é”™äº†å°†æ‰¾ä¸åˆ°ç”¨æˆ·ï¼Œè€Œsearch filterç”¨äºæ‰¾åˆ°ç”¨æˆ·ç»„ä¸­çš„ç”¨æˆ·(&amp;(objectClass=posixGroup)(memberUid={1}))ï¼Œè¿™é‡Œçš„ç”¨æˆ·ç»„ä¸»è¦ç”¨äºæˆæƒæ—¶ä½¿ç”¨ï¼Œå¯¹ç»„è¿›è¡Œæˆæƒã€‚</p>
<h2 id="æµ‹è¯•-2">æµ‹è¯•</h2>
<p>é…ç½®å®Œæˆå¯ä»¥ç‚¹å‡»test ldap settingsæµ‹è¯•ä¸€ä¸‹ï¼š</p>
<figure data-type="image" tabindex="15"><img src="https://koko-club.github.io/post-images/ldap/image-20230210104457142.png" alt="image-20230210104457142" loading="lazy"></figure>
<figure data-type="image" tabindex="16"><img src="https://koko-club.github.io/post-images/ldap/image-20230210104515248.png" alt="image-20230210104515248" loading="lazy"></figure>
<h1 id="ldap-for-gitlab">ldap for gitlab</h1>
<p>gitlabå¹¶ä¸èƒ½ç›´æ¥é€šçŸ¥é¡µé¢è®¾ç½®æ¥å¯¹æ¥ldapï¼Œè€Œæ˜¯é€šè¿‡é…ç½®æ–‡ä»¶ã€‚</p>
<h2 id="1-ldapé…ç½®äºŒè¿›åˆ¶éƒ¨ç½²">1ã€ldapé…ç½®ï¼ˆäºŒè¿›åˆ¶éƒ¨ç½²ï¼‰</h2>
<p>è¿™é‡Œé…ç½®åˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯äºŒè¿›åˆ¶åŒ…éƒ¨ç½²çš„gitlabï¼Œè¿™ä¸ªç”±äºæˆ‘å¹¶æ²¡æœ‰éƒ¨ç½²è¿‡ï¼Œæ‰€ä»¥ä¸‹é¢çš„é…ç½®æ‘˜æŠ„äºç½‘ä¸Šï¼Œä¸æ¸…æ¥šç‰ˆæœ¬æœ‰æ²¡æœ‰é…ç½®å˜åŒ–ï¼Œä½†é…ç½®å¤§è‡´çš„å­—æ®µåŸºæœ¬åº”è¯¥æ˜¯ä¸€è‡´çš„ï¼›è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯k8sçš„é…ç½®ï¼Œè¿™ç§ä¹Ÿæ˜¯ç›®å‰æˆ‘åœ¨ä½¿ç”¨çš„æ–¹å¼ï¼Œä¼šåœ¨ä¸‹é¢åˆ—å‡ºæ¥ã€‚</p>
<pre><code>å¦‚æœæ˜¯äºŒè¿›åˆ¶éƒ¨ç½²çš„åˆ™ç›´æ¥æ›´æ”¹é…ç½®æ–‡ä»¶
vi /etc/gitlab/gitlab.rb

gitlab_rails['ldap_enabled'] = true
gitlab_rails['prevent_ldap_sign_in'] = false
gitlab_rails['ldap_servers'] = {
'main' =&gt; {
  'label' =&gt; 'LDAP', # éšä¾¿è‡ªå®šä¹‰
  'host' =&gt;  '10.0.20.19', # ldapçš„serveråœ°å€
  'port' =&gt; 389, # ldapç«¯å£
  'uid' =&gt; 'cn', # é…ç½®ä¸ºcnæˆ–è€…snéƒ½å¯ä»¥ï¼Œä½†è¦æ³¨æ„ç”¨æˆ·åç§°å°†ä¼šä»¥æ­¤å¤„é…ç½®ä¸ºä¾æ®
  'bind_dn' =&gt; 'cn=admin,dc=aihelp,dc=net', # ç®¡ç†å‘˜è´¦å·
  'password' =&gt; '123456', # ç®¡ç†å‘˜å¯†ç 
  'encryption' =&gt; 'plain',  # åŠ å¯†
  'allow_username_or_email_login' =&gt; false,  # æ˜¯å¦å¯ç”¨é‚®ä»¶ä½œä¸ºç”¨æˆ·åç™»é™†
  'block_auto_created_users' =&gt; false, 
  'base' =&gt; 'dc=aihelp,dc=net',   # æ ¸å¿ƒé…ç½®ï¼Œè¡¨ç¤ºä»å“ªä¸€å±‚è¯»å–ç”¨æˆ·ä¿¡æ¯
  'user_filter' =&gt; '(memberof=cn=jenkins,ou=group,dc=aihelp,dc=net)', # LDAPç”¨æˆ·è¿›è¡Œè¿‡æ»¤
  'lowercase_usernames' =&gt; false,
  'group_base' =&gt; '',
  'admin_group' =&gt; '',
  'external_groups' =&gt; [],
  'sync_ssh_keys' =&gt; false
  }
}


</code></pre>
<pre><code>å…¶ä¸­ï¼š
label æ˜¯æ˜¾ç¤ºåœ¨GitLabç™»å½•æ¡†çš„ä¸Šæ–¹æ–‡å­—æè¿°ã€‚
host å’Œ port æ˜¯ LDAP æœåŠ¡çš„ä¸»æœºåœ°å€åŠç«¯å£
bind_dn å’Œ password æ˜¯ä¸€ä¸ªç®¡ç† LDAP çš„ dn åŠå¯†ç 
base è¡¨ç¤º LDAP å°†ä»¥è¯¥ dn ä¸º èŠ‚ç‚¹ï¼Œå‘ä¸‹æŸ¥æ‰¾ç”¨æˆ·
user_filter è¡¨ç¤ºä»¥æŸç§è¿‡æ»¤æ¡ä»¶ç­›é€‰ç”¨æˆ·ï¼Œæ¯”å¦‚å‡è®¾æˆ‘ä»¬åªå¸Œæœ›æ‰€å±ç»„ä¸º java-platform çš„ç”¨æˆ·æ¥è®¿é—® GitLabï¼Œåˆ™å¯ä»¥åœ¨è¿™é‡Œè®¾ç½® (memberOf=ou=java-platform,ou=people,dc=domain,dc=com)

é…ç½®æ·»åŠ ä¹‹åï¼Œä¾æ—§åƒå®‰è£…æ—¶å€™é‚£æ ·ï¼Œé‡è½½ä¸€ä¸‹é…ç½®ï¼š
gitlab-ctl reconfigure

 
Checking LDAP ...
LDAP: ... Server: ldapmain
LDAP authentication... Success
LDAP users with access to your GitLab server (only showing the first 100 results)
    DN: uid=test01,ou=people,dc=eryajf,dc=net    cn: ceshi
    DN: uid=test02,ou=people,dc=eryajf,dc=net    cn: test02
    DN: uid=test03,ou=people,dc=eryajf,dc=net    cn: test03
    DN: uid=admin,ou=people,dc=eryajf,dc=net     cn: Admin
Checking LDAP ... Finished
ä½¿ç”¨ldapç”¨æˆ·åå¯†ç è¿›è¡Œç™»é™†å³å¯ï¼Œæ­¤æ—¶ç™»é™†è¿›å»æ˜¯æ²¡æœ‰ä»»ä½•é¡¹ç›®çš„æƒé™ï¼Œå¦‚æœéœ€è¦æŸæƒé™ï¼Œå¯ä»¥å¯¹ç”¨æˆ·è¿›è¡Œç»„æˆ–è€…å•é¡¹ç›®çš„æˆæƒã€‚
</code></pre>
<h2 id="2-ldapé…ç½®k8s">2ã€ldapé…ç½®(k8s)</h2>
<p>ldapè¿™é‡Œç›´æ¥ç”¨helmçš„values.yamlä¼ é€’é…ç½®æ–‡ä»¶ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨ldapä¸­é…ç½®å°±è¡Œäº†ã€‚è¿™é‡Œå¦‚æœæ˜¯éƒ¨ç½²ä¹Ÿå»ºè®®é‡‡ç”¨helméƒ¨ç½²ï¼Œç”±äºgitlabæ–°ç‰ˆæœ¬æ¨¡å—è¿‡å¤šï¼Œå¦‚æœå†™yamlæ–‡ä»¶çš„è¯å†åŠ ä¸Šé…ç½®æ–‡ä»¶å’Œéœ€è¦æŒä¹…åŒ–çš„å­˜å‚¨è·¯å¾„å¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥ä½¿ç”¨helmæ˜¯æ¯”è¾ƒç†æƒ³çš„æ–¹å¼ã€‚</p>
<pre><code>values.yaml:
----
    ldap:
      # prevent the use of LDAP for sign-in via web.
      preventSignin: false
      servers:
        main:
          label: 'LDAP' 
          host: '192.168.110.29' #ldapåœ°å€
          port: 30389 #ç«¯å£
          uid: 'uid' 
          bind_dn: 'cn=admin,dc=finsiot,dc=com' #ç®¡ç†å‘˜è·¯å¾„
          password: #ç®¡ç†å‘˜å¯†ç 
            secret: my-ldap-password-secret
            key: the-key-containing-the-password
          encryption: 'plain'
          base: 'ou=people,dc=finsiot,dc=com' #ç”¨æˆ·è·¯å¾„
          verify_certificates: true #å¿½ç•¥è¯ä¹¦
          active_directory: false
          allow_username_or_email_login: true #æ”¯æŒé‚®ä»¶å’Œç”¨æˆ·åç™»å½•
          block_auto_created_users: false
          user_filter: ''
          attributes:
            username: ['cn'] #ç”¨æˆ·åå¯¹åº”ldapå­—æ®µ
            email:    ['mail','email'] #é‚®ç®±å¯¹åº”ldapå­—æ®µ
            name:     'description' #ç”¨æˆ·æ˜¾ç¤ºåå­—å¯¹åº”ldapå­—æ®µ
            fister_name: 'givenName' 
            last_name:  'sn'
</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œgitlab-ceä»…æ”¯æŒldapçš„ç”¨æˆ·é…ç½®ï¼Œä¸æ”¯æŒldapç”¨æˆ·ç»„çš„é…ç½®ï¼Œå¦‚æœæƒ³è¦ä½¿ç”¨ldapç”¨æˆ·ç»„ï¼Œéœ€è¦ä½¿ç”¨gitlab-eeï¼ˆå•†ä¸šç‰ˆæœ¬ï¼‰ã€‚</p>
<p>ldapçš„é…ç½®æ–‡ä»¶æ˜¯configmapï¼šgitlab-webserviceä¸‹é¢çš„gitlab.yml.erbï¼ŒæŒ‚è½½äºgitlab-webservice-defaultçš„/var/opt/gitlab/templates/gitlab.yml.erbè·¯å¾„ã€‚</p>
<h3 id="gitlabæ‹‰å–ldapè´¦å·æ•°æ®">gitlabæ‹‰å–ldapè´¦å·æ•°æ®</h3>
<h4 id="é—®é¢˜">é—®é¢˜</h4>
<p>ldapä¸åº”ç”¨ç»“åˆä¸€èˆ¬æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯æœåŠ¡éœ€è¦ç™»å½•æ—¶å»è°ƒç”¨ldapçš„è´¦å·æ•°æ®å®ç°ç»“åˆï¼Œè¿˜æœ‰ä¸€ç§æ˜¯æœåŠ¡é¢„å…ˆå°†ldapå­˜åœ¨è‡ªå·±æ•°æ®åº“ä¸­ç„¶åé€šè¿‡ldapçš„è´¦å·è¿›è¡Œç™»å½•ã€‚è€Œgitlabåˆ™æ˜¯åè€…ï¼Œè¿™ç§æƒ…å†µä¼šå¯¼è‡´æ–°åŠ äº†è´¦å·ä½†æ˜¯ldapå´æ²¡åŠæ³•ç›´æ¥ç”¨æ–°è´¦å·ç™»å½•ï¼Œå› ä¸ºgitlabå¹¶éæ˜¯ç™»å½•ç›´æ¥å»ldapè°ƒç”¨ï¼Œè€Œæ˜¯ä»è‡ªå·±æ•°æ®åº“ä¸­æ‰¾ldapè´¦å·æ•°æ®ã€‚</p>
<h4 id="è§£å†³åŠæ³•">è§£å†³åŠæ³•</h4>
<h5 id="1-å®šæ—¶">1ã€å®šæ—¶</h5>
<p>â€‹		å¯ä»¥åœ¨gitlabä¸­è®¾ç½®æ¯æ—¥å®šæ—¶ä»»åŠ¡ï¼Œå®šæ—¶ä»ldapä¸­æ‹‰å–æ•°æ®åˆ°è‡ªå·±çš„æ•°æ®åº“ã€‚</p>
<pre><code>K8S:
	è¿™é‡Œk8sæ˜¯åœ¨helmçš„éƒ¨ç½²æ–‡ä»¶values.yamlæ·»åŠ ä¿®æ”¹ï¼š
	cron_jobs:
	   ldap_sync_worker:
         cron: &quot;30 1 * * *&quot;
       ldap_group_sync_worker:
         cron: &quot;0 * * * *&quot;
äºŒè¿›åˆ¶éƒ¨ç½²ï¼š
	è¯·æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.gitlab.cn/jh/administration/auth/ldap/ldap_synchronization.html

</code></pre>
<h5 id="2-æ‰‹åŠ¨æ‹‰å–">2ã€æ‰‹åŠ¨æ‹‰å–</h5>
<pre><code>æ‰‹åŠ¨æ‹‰å–ä½¿ç”¨gitlab-rake gitlab:ldap:checkå‘½ä»¤å°±å¯ä»¥ï¼Œè¿™ä¸ªæ˜¯æµ‹è¯•ladpçš„å‘½ä»¤ï¼Œæµ‹è¯•çš„åŒæ—¶ä¼šæ‹‰å–ä¸€éæ•°æ®ã€‚
å¦‚æœæ˜¯k8séœ€è¦åœ¨gitlab-toolboxå®¹å™¨ä¸­æ‰§è¡Œè¯¥å‘½ä»¤
</code></pre>
<h1 id="mindoc-for-ldap">mindoc for ldap</h1>
<p>mindocæ˜¯ä¸€æ¬¾å¼€æºwikiæœåŠ¡ï¼Œç”±äºæ¯”è¾ƒå†·é—¨ï¼Œåé¢å¯èƒ½å‡ ä¹ç”¨ä¸åˆ°ï¼Œè¿™é‡Œå°±ç®€ç•¥è®°å½•ä¸€ä¸‹ï¼Œç›´æ¥è´´ä¸Šé…ç½®æ–‡ä»¶</p>
<pre><code>app.conf #mindocé…ç½®æ–‡ä»¶
     #æ˜¯å¦å¯ç”¨ldap
    ldap_enable=true
    #ldapä¸»æœºå
    ldap_host=192.168.110.29
    #ldapç«¯å£
    ldap_port=30389
    #ldapå†…å“ªä¸ªå±æ€§ä½œä¸ºç”¨æˆ·å
    ldap_attribute=uid
    #æœç´¢èŒƒå›´
    ldap_base=dc=finsiot,dc=com
    #ç¬¬ä¸€æ¬¡ç»‘å®šldapç”¨æˆ·dn
    ldap_user=cn=admin,dc=finsiot,dc=com
    #ç¬¬ä¸€æ¬¡ç»‘å®šldapç”¨æˆ·å¯†ç 
    ldap_password=123456
    #è‡ªåŠ¨æ³¨å†Œç”¨æˆ·è§’è‰²ï¼š0 è¶…çº§ç®¡ç†å‘˜ /1 ç®¡ç†å‘˜/ 2 æ™®é€šç”¨æˆ·
    ldap_user_role=2
    #ldapæœç´¢filterè§„åˆ™,ADæœåŠ¡å™¨: objectClass=User, openldapæœåŠ¡å™¨: objectClass=posixAccount ,ä¹Ÿå¯ä»¥å®šä¹‰ä¸ºå…¶ä»–å±æ€§,å¦‚: title=mindoc
    ldap_filter=objectClass=posixAccount

</code></pre>
<p>ç›´æ¥é…ç½®å¥½é‡å¯åº”ç”¨å°±å¯ä»¥ä½¿ç”¨ldapè´¦å·ç™»å½•äº†ã€‚</p>
<h1 id="zentao-for-ldap">zentao for ldap</h1>
<p>ç¦…é“æœåŠ¡æ¥å…¥ldap</p>
<h2 id="ldapæ’ä»¶éƒ¨ç½²">ldapæ’ä»¶éƒ¨ç½²</h2>
<p>ç¦…é“æœ¬èº«ä¸æ”¯æŒldapï¼Œéœ€è¦é¢å¤–å®‰è£…ldapæ’ä»¶ã€‚æ’ä»¶åœ°å€ï¼šhttps://github.com/yihoyoung/zentao-ldap</p>
<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ç›®å‰è¿™ä¸ªç‰ˆæœ¬æœ€é«˜ä»…æ”¯æŒç¦…é“12ï¼Œæœ¬äººæµ‹è¯•åœ¨ç¦…é“18ç‰ˆæœ¬ä¸Šé¢ä¸å…¼å®¹ã€‚</strong></p>
<p>å…¶å®‰è£…æ­¥éª¤åœ¨githubçš„readmeä¸­æœ‰è¯´æ˜ï¼š</p>
<pre><code>1.æ‰“åŒ… ldap æ–‡ä»¶å¤¹ä¸º ldap.zip æ–‡ä»¶
2.åˆ›å»ºæ–‡ä»¶ï¼š
touch /www/zentaopms/www/ok.txt
3.admin è´¦æˆ·ç™»é™†ç¦…é“ï¼Œåå° -&gt; æ’ä»¶ -&gt; æœ¬åœ°å®‰è£…ï¼Œé€‰æ‹©æ‰“åŒ…çš„ ldap.zip æ–‡ä»¶å®‰è£…å³å¯
</code></pre>
<h3 id="å…·ä½“æ­¥éª¤">å…·ä½“æ­¥éª¤</h3>
<p>ä¸‹è½½ldapä»£ç ï¼Œå°†è¿™ä¸ªæ–‡ä»¶æ‰“åŒ…æˆzipã€‚</p>
<figure data-type="image" tabindex="17"><img src="https://koko-club.github.io/post-images/ldap/image-20230213152207304.png" alt="image-20230213152207304" loading="lazy"></figure>
<p>åœ¨æœåŠ¡å™¨ä¸Šé¢åˆ›å»ºè¯¥æ–‡ä»¶ï¼štouch /www/zentaopms/www/ok.txt</p>
<p>ç„¶åç™»å½•ç¦…é“ç®¡ç†å‘˜è´¦å·ï¼Œéƒ¨ç½²æ’ä»¶å¦‚ä¸‹ï¼š</p>
<figure data-type="image" tabindex="18"><img src="https://koko-club.github.io/post-images/ldap/image-20230213152502090.png" alt="image-20230213152502090" loading="lazy"></figure>
<p>å®‰è£…æ–‡ä»¶æ—¶æç¤ºç‰ˆæœ¬ä¸å…¼å®¹ç‚¹å‡»å¼ºåˆ¶å®‰è£…å³å¯ã€‚</p>
<figure data-type="image" tabindex="19"><img src="https://koko-club.github.io/post-images/ldap/image-20230213152747071.png" alt="image-20230213152747071" loading="lazy"></figure>
<p>å®‰è£…æˆåŠŸä»¥ååå°ä¼šæœ‰ldapé…ç½®é¡¹ï¼š</p>
<figure data-type="image" tabindex="20"><img src="https://koko-club.github.io/post-images/ldap/image-20230213140948096.png" alt="image-20230213140948096" loading="lazy"></figure>
<h2 id="ldapé…ç½®è¯´æ˜">ldapé…ç½®è¯´æ˜</h2>
<pre><code>LDAPæœåŠ¡å™¨: ldapåœ°å€
åè®®ç‰ˆæœ¬ï¼š é»˜è®¤å¡«å†™3
BindDNï¼š ç®¡ç†è´¦å·åœ°å€
BindDN å¯†ç :	ç®¡ç†è´¦æˆ·å¯†ç 
BaseDN: ç”¨æˆ·åœ°å€
Search filter: æœç´¢ç”¨æˆ·çš„æ¡ä»¶ï¼Œopenldapè¿™ä¸ªæœåŠ¡é»˜è®¤æ˜¯objectClass=posixAccountï¼Œä¸åŒçš„ldapæœåŠ¡ä¸ä¸€æ ·
è´¦å·å­—æ®µ: ç™»å½•ç”¨æˆ·åå­—æ®µ
EMail å­—æ®µ: é‚®ç®±å­—æ®µ
å§“åå­—æ®µ: åå­—å­—æ®µ
</code></pre>
<p>ldapé…ç½®å®Œä»¥åå…ˆç‚¹å‡»ä¿å­˜é…ç½®ï¼Œç„¶åç‚¹å‡»æ‰‹åŠ¨åŒæ­¥ï¼Œå¦‚æœæœ‰åŒæ­¥çš„ç”¨æˆ·ä¿¡æ¯é‚£å°±è¡¨ç¤ºæ²¡é—®é¢˜äº†ã€‚</p>
<figure data-type="image" tabindex="21"><img src="https://koko-club.github.io/post-images/ldap/image-20230213153228070.png" alt="image-20230213153228070" loading="lazy"></figure>
<p>æœ€ååœ¨ç»„ç»‡-ã€‹ç”¨æˆ·ä¸­æŸ¥çœ‹å·²ç»é€šè¿‡ldapå¯¼å…¥çš„ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<p>æ³¨æ„ï¼šé…ç½®äº†ldapä»¥åç³»ç»ŸåŸè´¦å·ç™»å½•éœ€è¦åœ¨ç”¨æˆ·åå‰é¢åŠ ä¸Šâ€œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">â€</mi><mi mathvariant="normal">ç¬¦</mi><mi mathvariant="normal">å·</mi><mi mathvariant="normal">ï¼Œ</mi><mi mathvariant="normal">ä¾‹</mi><mi mathvariant="normal">å¦‚</mi></mrow><annotation encoding="application/x-tex">â€ç¬¦å·ï¼Œä¾‹å¦‚</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">â€</span><span class="mord cjk_fallback">ç¬¦</span><span class="mord cjk_fallback">å·</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ä¾‹</span><span class="mord cjk_fallback">å¦‚</span></span></span></span>adminã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://koko-club.github.io/post/hello-gridea/</id>
        <link href="https://koko-club.github.io/post/hello-gridea/">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="https://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>